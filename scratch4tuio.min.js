/*!
 * Scratch4TUIO v0.9.1 (https://github.com/caesarion/Scratch4TuioExtension)
 * Copyright 2015-2015 Sebastian Thiele <s.thiele87@yahoo.de>
 * Licensed under the MIT license
 */
if("undefined"==typeof window.extensionWasLoaded){var osc=osc||{};!function(){"use strict";osc.SECS_70YRS=2208988800,osc.TWO_32=4294967296,osc.defaults={metadata:!1,unpackSingleArgs:!0},osc.isBufferEnv="undefined"!=typeof Buffer,osc.isCommonJS="undefined"!=typeof module&&module.exports,osc.isNode=osc.isCommonJS&&"undefined"==typeof window,osc.isArray=function(a){return a&&"[object Array]"===Object.prototype.toString.call(a)},osc.isTypedArrayView=function(a){return a.buffer&&a.buffer instanceof ArrayBuffer},osc.isBuffer=function(a){return osc.isBufferEnv&&a instanceof Buffer};var a="undefined"!=typeof dcodeIO?dcodeIO.Long:"undefined"!=typeof a?a:osc.isNode?require("long"):void 0;osc.dataView=function(a,b,c){return a.buffer?new DataView(a.buffer,b,c):a instanceof ArrayBuffer?new DataView(a,b,c):new DataView(new Uint8Array(a),b,c)},osc.byteArray=function(a){if(a instanceof Uint8Array)return a;var b=a.buffer?a.buffer:a;if(!(b instanceof ArrayBuffer||"undefined"!=typeof b.length&&"string"!=typeof b))throw new Error("Can't wrap a non-array-like object as Uint8Array. Object was: "+JSON.stringify(a,null,2));return new Uint8Array(b)},osc.nativeBuffer=function(a){return osc.isBufferEnv?osc.isBuffer(a)?a:new Buffer(a.buffer?a:new Uint8Array(a)):osc.isTypedArrayView(a)?a:new Uint8Array(a)},osc.copyByteArray=function(a,b,c){if(osc.isTypedArrayView(a)&&osc.isTypedArrayView(b))b.set(a,c);else for(var d=void 0===c?0:c,e=Math.min(b.length-c,a.length),f=0,g=d;e>f;f++,g++)b[g]=a[f];return b},osc.readString=function(a,b){for(var c=[],d=b.idx;d<a.byteLength;d++){var e=a.getUint8(d);if(0===e){d++;break}c.push(e)}return d=d+3&-4,b.idx=d,String.fromCharCode.apply(null,c)},osc.writeString=function(a){for(var b=a+"\x00",c=b.length,d=c+3&-4,e=new Uint8Array(d),f=0;f<b.length;f++){var g=b.charCodeAt(f);e[f]=g}return e},osc.readPrimitive=function(a,b,c,d){var e=a[b](d.idx,!1);return d.idx+=c,e},osc.writePrimitive=function(a,b,c,d,e){e=void 0===e?0:e;var f;return b?f=new Uint8Array(b.buffer):(f=new Uint8Array(d),b=new DataView(f.buffer)),b[c](e,a,!1),f},osc.readInt32=function(a,b){return osc.readPrimitive(a,"getInt32",4,b)},osc.writeInt32=function(a,b,c){return osc.writePrimitive(a,b,"setInt32",4,c)},osc.readInt64=function(b,c){var d=osc.readPrimitive(b,"getInt32",4,c),e=osc.readPrimitive(b,"getInt32",4,c);return a?new a(e,d):{high:d,low:e,unsigned:!1}},osc.writeInt64=function(a,b,c){var d=new Uint8Array(8);return d.set(osc.writePrimitive(a.high,b,"setInt32",4,c),0),d.set(osc.writePrimitive(a.low,b,"setInt32",4,c+4),4),d},osc.readFloat32=function(a,b){return osc.readPrimitive(a,"getFloat32",4,b)},osc.writeFloat32=function(a,b,c){return osc.writePrimitive(a,b,"setFloat32",4,c)},osc.readFloat64=function(a,b){return osc.readPrimitive(a,"getFloat64",8,b)},osc.writeFloat64=function(a,b,c){return osc.writePrimitive(a,b,"setFloat64",8,c)},osc.readChar32=function(a,b){var c=osc.readPrimitive(a,"getUint32",4,b);return String.fromCharCode(c)},osc.writeChar32=function(a,b,c){var d=a.charCodeAt(0);return void 0===d||-1>d?void 0:osc.writePrimitive(d,b,"setUint32",4,c)},osc.readBlob=function(a,b){var c=osc.readInt32(a,b),d=c+3&-4,e=new Uint8Array(a.buffer,b.idx,c);return b.idx+=d,e},osc.writeBlob=function(a){a=osc.byteArray(a);var b=a.byteLength,c=b+3&-4,d=4,e=c+d,f=new Uint8Array(e),g=new DataView(f.buffer);return osc.writeInt32(b,g),f.set(a,d),f},osc.readMIDIBytes=function(a,b){var c=new Uint8Array(a.buffer,b.idx,4);return b.idx+=4,c},osc.writeMIDIBytes=function(a){a=osc.byteArray(a);var b=new Uint8Array(4);return b.set(a),b},osc.readColor=function(a,b){var c=new Uint8Array(a.buffer,b.idx,4),d=c[3]/255;return b.idx+=4,{r:c[0],g:c[1],b:c[2],a:d}},osc.writeColor=function(a){var b=Math.round(255*a.a),c=new Uint8Array([a.r,a.g,a.b,b]);return c},osc.readTrue=function(){return!0},osc.readFalse=function(){return!1},osc.readNull=function(){return null},osc.readImpulse=function(){return 1},osc.readTimeTag=function(a,b){var c=osc.readPrimitive(a,"getUint32",4,b),d=osc.readPrimitive(a,"getUint32",4,b),e=0===c&&1===d?Date.now():osc.ntpToJSTime(c,d);return{raw:[c,d],"native":e}},osc.writeTimeTag=function(a){var b=a.raw?a.raw:osc.jsToNTPTime(a["native"]),c=new Uint8Array(8),d=new DataView(c.buffer);return osc.writeInt32(b[0],d,0),osc.writeInt32(b[1],d,4),c},osc.timeTag=function(a,b){a=a||0,b=b||Date.now();var c=b/1e3,d=Math.floor(c),e=c-d,f=Math.floor(a),g=a-f,h=e+g;if(h>1){var i=Math.floor(h),j=h-i;f+=i,h=j}var k=d+f+osc.SECS_70YRS,l=Math.round(osc.TWO_32*h);return{raw:[k,l]}},osc.ntpToJSTime=function(a,b){var c=a-osc.SECS_70YRS,d=b/osc.TWO_32,e=1e3*(c+d);return e},osc.jsToNTPTime=function(a){var b=a/1e3,c=Math.floor(b),d=b-c,e=c+osc.SECS_70YRS,f=Math.round(osc.TWO_32*d);return[e,f]},osc.readArguments=function(a,b,c){var d=osc.readString(a,c);if(0!==d.indexOf(","))throw new Error("A malformed type tag string was found while reading the arguments of an OSC message. String was: "+d," at offset: "+c.idx);var e=d.substring(1).split(""),f=[];return osc.readArgumentsIntoArray(f,e,d,a,b,c),f},osc.readArgument=function(a,b,c,d,e){var f=osc.argumentTypes[a];if(!f)throw new Error("'"+a+"' is not a valid OSC type tag. Type tag string was: "+b);var g=f.reader,h=osc[g](c,e);return d.metadata&&(h={type:a,value:h}),h},osc.readArgumentsIntoArray=function(a,b,c,d,e,f){for(var g=0;g<b.length;){var h,i=b[g];if("["===i){var j=b.slice(g+1),k=j.indexOf("]");if(0>k)throw new Error("Invalid argument type tag: an open array type tag ('[') was found without a matching close array tag ('[]'). Type tag was: "+c);var l=j.slice(0,k);h=osc.readArgumentsIntoArray([],l,c,d,e,f),g+=k+2}else h=osc.readArgument(i,c,d,e,f),g++;a.push(h)}return a},osc.writeArguments=function(a,b){var c=osc.collectArguments(a,b);return osc.joinParts(c)},osc.joinParts=function(a){for(var b=new Uint8Array(a.byteLength),c=a.parts,d=0,e=0;e<c.length;e++){var f=c[e];osc.copyByteArray(f,b,d),d+=f.length}return b},osc.addDataPart=function(a,b){b.parts.push(a),b.byteLength+=a.length},osc.writeArrayArguments=function(a,b){for(var c="[",d=0;d<a.length;d++){var e=a[d];c+=osc.writeArgument(e,b)}return c+="]"},osc.writeArgument=function(a,b){if(osc.isArray(a))return osc.writeArrayArguments(a,b);var c=a.type,d=osc.argumentTypes[c].writer;if(d){var e=osc[d](a.value);osc.addDataPart(e,b)}return a.type},osc.collectArguments=function(a,b,c){osc.isArray(a)||(a=[a]),c=c||{byteLength:0,parts:[]},b.metadata||(a=osc.annotateArguments(a));for(var d=",",e=c.parts.length,f=0;f<a.length;f++){var g=a[f];d+=osc.writeArgument(g,c)}var h=osc.writeString(d);return c.byteLength+=h.byteLength,c.parts.splice(e,0,h),c},osc.readMessage=function(a,b,c){b=b||osc.defaults;var d=osc.dataView(a,a.byteOffset,a.length);c=c||{idx:0};var e=osc.readString(d,c);return osc.readMessageContents(e,d,b,c)},osc.readMessageContents=function(a,b,c,d){if(0!==a.indexOf("/"))throw new Error("A malformed OSC address was found while reading an OSC message. String was: "+a);var e=osc.readArguments(b,c,d);return{address:a,args:1===e.length&&c.unpackSingleArgs?e[0]:e}},osc.collectMessageParts=function(a,b,c){return c=c||{byteLength:0,parts:[]},osc.addDataPart(osc.writeString(a.address),c),osc.collectArguments(a.args,b,c)},osc.writeMessage=function(a,b){if(b=b||osc.defaults,!osc.isValidMessage(a))throw new Error("An OSC message must contain a valid address. Message was: "+JSON.stringify(a,null,2));var c=osc.collectMessageParts(a,b);return osc.joinParts(c)},osc.isValidMessage=function(a){return a.address&&0===a.address.indexOf("/")},osc.readBundle=function(a,b,c){return osc.readPacket(a,b,c)},osc.collectBundlePackets=function(a,b,c){c=c||{byteLength:0,parts:[]},osc.addDataPart(osc.writeString("#bundle"),c),osc.addDataPart(osc.writeTimeTag(a.timeTag),c);for(var d=0;d<a.packets.length;d++){var e=a.packets[d],f=e.address?osc.collectMessageParts:osc.collectBundlePackets,g=f(e,b);c.byteLength+=g.byteLength,osc.addDataPart(osc.writeInt32(g.byteLength),c),c.parts=c.parts.concat(g.parts)}return c},osc.writeBundle=function(a,b){if(!osc.isValidBundle(a))throw new Error("An OSC bundle must contain 'timeTag' and 'packets' properties. Bundle was: "+JSON.stringify(a,null,2));b=b||osc.defaults;var c=osc.collectBundlePackets(a,b);return osc.joinParts(c)},osc.isValidBundle=function(a){return void 0!==a.timeTag&&void 0!==a.packets},osc.readBundleContents=function(a,b,c,d){for(var e=osc.readTimeTag(a,c),f=[];c.idx<d;){var g=osc.readInt32(a,c),h=c.idx+g,i=osc.readPacket(a,b,c,h);f.push(i)}return{timeTag:e,packets:f}},osc.readPacket=function(a,b,c,d){var e=osc.dataView(a,a.byteOffset,a.length);d=void 0===d?e.byteLength:d,c=c||{idx:0};var f=osc.readString(e,c),g=f[0];if("#"===g)return osc.readBundleContents(e,b,c,d);if("/"===g)return osc.readMessageContents(f,e,b,c);throw new Error("The header of an OSC packet didn't contain an OSC address or a #bundle string. Header was: "+f)},osc.writePacket=function(a,b){if(osc.isValidMessage(a))return osc.writeMessage(a,b);if(osc.isValidBundle(a))return osc.writeBundle(a,b);throw new Error("The specified packet was not recognized as a valid OSC message or bundle. Packet was: "+JSON.stringify(a,null,2))},osc.argumentTypes={i:{reader:"readInt32",writer:"writeInt32"},h:{reader:"readInt64",writer:"writeInt64"},f:{reader:"readFloat32",writer:"writeFloat32"},s:{reader:"readString",writer:"writeString"},S:{reader:"readString",writer:"writeString"},b:{reader:"readBlob",writer:"writeBlob"},t:{reader:"readTimeTag",writer:"writeTimeTag"},T:{reader:"readTrue"},F:{reader:"readFalse"},N:{reader:"readNull"},I:{reader:"readImpulse"},d:{reader:"readFloat64",writer:"writeFloat64"},c:{reader:"readChar32",writer:"writeChar32"},r:{reader:"readColor",writer:"writeColor"},m:{reader:"readMIDIBytes",writer:"writeMIDIBytes"}},osc.inferTypeForArgument=function(a){var b=typeof a;switch(b){case"boolean":return a?"T":"F";case"string":return"s";case"number":return"f";case"undefined":return"N";case"object":if(null===a)return"N";if(a instanceof Uint8Array||a instanceof ArrayBuffer)return"b";if(a.high instanceof Number&&a.low instanceof Number)return"h"}throw new Error("Can't infer OSC argument type for value: "+JSON.stringify(a,null,2))},osc.annotateArguments=function(a){osc.isArray(a)||(a=[a]);for(var b=[],c=0;c<a.length;c++){var d,e=a[c];if("object"==typeof e&&e.type&&void 0!==e.value)d=e;else{var f=osc.inferTypeForArgument(e);d={type:f,value:e}}b.push(d)}return b},osc.isCommonJS&&(module.exports=osc)}(),function(a,b){"use strict";function c(a){return new d(a)}function d(a){this._wrapped=a}function e(){for(var a,b=-1,c={},d={},e={},f=["beforeLoop","loopExp","inLoop","afterLoop"];++b<arguments.length;)for(a in arguments[b])e[a]=arguments[b][a];for(;a=f.pop();)"object"==typeof e[a]?(c[a]=e[a].array,d[a]=e[a].object):c[a]=d[a]=e[a]||"";var g=e.args,h=/^[^,]+/.exec(g)[0],i=e.init,j=e.iterate,k=!("object"==g||"objects"==j),l=!("array"==g||"arrays"==j),m=e.useHas!==!1;return Function("arrayClass,bind,concat,funcClass,hasOwnProperty,identity,indexOf,Infinity,isArray,isEmpty,Math,slice,stringClass,toString,undefined",'"use strict";return function('+g+"){\n"+(e.top||"")+";\nvar index, result"+(i?"="+i:"")+";\nif("+h+"==undefined)return "+(e.exits||"result")+";\n"+(k?"var length="+h+".length;\nindex=-1;\n"+((l?"if(length===+length){\n":"")+(c.beforeLoop||"")+";\nwhile("+(c.loopExp||"++index<length")+"){\n"+c.inLoop+"\n}"+(c.afterLoop||"")+";\n"+(l?"\n}\n":"")):"")+(l?(k?"else{\n":"")+(d.beforeLoop||"")+";\nfor("+(d.loopExp||"index in "+h)+"){\n"+(m?"if(hasOwnProperty.call("+/\S+$/.exec(d.loopExp||h)[0]+",index)){\n":"")+d.inLoop+(m?"\n}":"")+"\n}"+(d.afterLoop||"")+";\n"+(k?"\n}\n":""):"")+(e.bottom||"")+";\nreturn "+(e.returns||"result")+"\n}")(sa,B,Ba,va,Ca,ba,q,1/0,Ta,Ua,Math,Ea,ya,Fa)}function f(a){return a.replace(ra,function(a,b){return la[b]})}function g(a,b,c){var d={};if(!S(b)){var e=b;b=function(a){return a[e]}}return Za(a,function(a,c,e){var f=b(a,c,e);(d[f]||(d[f]=[])).push(a)}),d}function h(a,b){var c=Ea.call(arguments,2),d=S(b);return $a(a,function(a){return(d?b||a:a[b]).apply(a,c)})}function i(a,c,d,e){var f=arguments.length>2;if(a==b)return d;e&&(c=B(c,e));var g=a.length;if(g===+g){for(g&&!f&&(d=a[--g]);g--;)d=c(d,a[g],g,a);return d}var h,i=nb(a);for(g=i.length,g&&!f&&(d=a[i[--g]]);g--;)h=i[g],d=c(d,a[h],h,a);return d}function j(a){var b,c=[];return Za(a,function(a,d){b=Math.floor(Math.random()*(d+1)),c[d]=c[b],c[b]=a}),c}function k(a){var b=Fa.call(a);return b==sa||b==ya?a.length:nb(a).length}function l(a,c,d){if(S(c))d&&(c=B(c,d));else{var e=c;c=function(a){return a[e]}}return bb($a(a,function(b,d){return{criteria:c(b,d,a),value:b}}).sort(function(a,c){var d=a.criteria,e=c.criteria;return d===b?1:e===b?-1:e>d?-1:d>e?1:0}),"value")}function m(a,b,c){var d=0,e=a.length;for(c||(c=ba);e>d;){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d}function n(a){if(!a)return[];if(S(a.toArray))return a.toArray();var b=a.length;return b===+b?Ea.call(a):fb(a)}function o(a,c,d){return c==b||d?a[0]:Ea.call(a,0,c)}function p(a,b){return b?Ba.apply([],a):cb(a,function(a,b){return Ta(b)?(Da.apply(a,p(b)),a):(a.push(b),a)},[])}function q(a,c,d){var e,f;if(a==b)return-1;if(d)return e=m(a,c),a[e]===c?e:-1;for(e=0,f=a.length;f>e;e++)if(a[e]===c)return e;return-1}function r(a,c,d){return Ea.call(a,0,-(c==b||d?1:c))}function s(a){var b=Ea.call(arguments,1);return Xa(y(a),function(a){return Wa(b,function(b){return q(b,a)>=0})})}function t(a,c,d){var e=a.length;return c==b||d?a[e-1]:Ea.call(a,-c||e)}function u(a,c){if(a==b)return-1;for(var d=a.length;d--;)if(a[d]===c)return d;return-1}function v(a,b,c){c||(c=1),arguments.length<2&&(b=a||0,a=0);for(var d=-1,e=Math.max(Math.ceil((b-a)/c),0),f=Array(e);++d<e;)f[d]=a,a+=c;return f}function w(a,c,d){return Ea.call(a,c==b||d?1:c)}function x(){return y(p(arguments,!0))}function y(a,b,c){var d=c?$a(a,c):a,e=[];return a.length<3&&(b=!0),cb(d,function(c,d,f){return(b?t(c)!==d||!c.length:q(c,d)<0)&&(c.push(d),e.push(a[f])),c},[]),e}function z(){for(var a=-1,b=_a(bb(arguments,"length")),c=Array(b);++a<b;)c[a]=bb(arguments,a);return c}function A(a,b){return 1>a?b():function(){return--a<1?b.apply(this,arguments):void 0}}function B(a,b){var c=Ea.call(arguments,2),d=c.length;return function(){return c.length=d,Da.apply(c,arguments),a.apply(b,c)}}function C(a){var b=arguments,c=1;1==b.length&&(c=0,b=lb(a));for(var d=b.length;d>c;c++)a[b[c]]=B(a[b[c]],a);return a}function D(){var a=arguments;return function(){for(var b=arguments,c=a.length;c--;)b=[a[c].apply(this,b)];return b[0]}}function E(a,c,d){var e;return function(){var f=arguments,g=this;d&&!e&&a.apply(g,f),clearTimeout(e),e=Ka(function(){e=b,d||a.apply(g,f)},c)}}function F(a,c){var d=Ea.call(arguments,2);return Ka(function(){return a.apply(b,d)},c)}function G(a){var c=Ea.call(arguments,1);return Ka(function(){return a.apply(b,c)},1)}function H(a,b){var c={};return function(){var d=b?b.apply(this,arguments):arguments[0];return Ca.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}}function I(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments))}}function J(a,c){var d,e,f,g,h,i,j=E(function(){e=h=!1},c);return function(){return d=arguments,g=this,i||(i=Ka(function(){i=b,e&&a.apply(g,d),j()},c)),h?e=!0:f=a.apply(g,d),j(),h=!0,f}}function K(a,b){return function(){var c=[a];return Da.apply(c,arguments),b.apply(this,c)}}function L(a){return a!==Object(a)?a:Ta(a)?a.slice():kb({},a)}function M(a,b){return Ca.call(a,b)}function N(a){return a===!0||a===!1||Fa.call(a)==ta}function O(a){return Fa.call(a)==ua}function P(a){return!(!a||1!=a.nodeType)}function Q(a,c,d){if(d||(d=[]),a===c)return 0!==a||1/a==1/c;if(a==b||c==b)return a===c;if(a._chain&&(a=a._wrapped),c._chain&&(c=c._wrapped),a.isEqual&&S(a.isEqual))return a.isEqual(c);if(c.isEqual&&S(c.isEqual))return c.isEqual(a);var e=Fa.call(a);if(e!=Fa.call(c))return!1;switch(e){case ya:return a==String(c);case wa:return a!=+a?c!=+c:0==a?1/a==1/c:a==+c;case ta:case ua:return+a==+c;case xa:return a.source==c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if("object"!=typeof a||"object"!=typeof c)return!1;for(var f=d.length;f--;)if(d[f]==a)return!0;var g=!0,h=0;if(d.push(a),e==sa){if(h=a.length,g=h==c.length)for(;h--&&(g=h in a==h in c&&Q(a[h],c[h],d)););}else{if("constructor"in a!="constructor"in c||a.constructor!=c.constructor)return!1;for(var i in a)if(Ca.call(a,i)&&(h++,!(g=Ca.call(c,i)&&Q(a[i],c[i],d))))break;if(g){for(i in c)if(Ca.call(c,i)&&!h--)break;g=!h}}return d.pop(),g}function R(a){return Ia(a)&&Fa.call(a)==wa}function S(a){return Fa.call(a)==va}function T(a){return a===Object(a)}function U(a){return Fa.call(a)==wa&&a!=+a}function V(a){return null===a}function W(a){return Fa.call(a)==wa}function X(a){return Fa.call(a)==xa}function Y(a){return Fa.call(a)==ya}function Z(a){return a===b}function $(a){for(var b,c=-1,d=p(Ea.call(arguments,1)),e=d.length,f={};++c<e;)b=d[c],b in a&&(f[b]=a[b]);return f}function _(a,b){return b(a),a}function aa(a){return(a+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}function ba(a){return a}function ca(a){Za(lb(a),function(b){var e=c[b]=a[b];c.prototype[b]=function(){var a=Ea.call(arguments);Ga.call(a,this._wrapped);var b=e.apply(c,a);return this._chain?new d(b).chain():b}})}function da(){return a._=oa,this}function ea(a,c){if(a==b)return null;var d=a[c];return S(d)?a[c]():d}function fa(a,b,c){c&&(b=B(b,c));for(var d=0;a>d;d++)b(d)}function ga(a){var b=na++;return a?a+b:b}function ha(a,b,d){d=jb(d||{},c.templateSettings);var e="__p+='"+a.replace(pa,function(a){return"\\"+la[a]}).replace(d.escape||qa,function(a,b){return"'+\n((__t=("+f(b)+"))==null?'':_.escape(__t))+\n'"}).replace(d.interpolate||qa,function(a,b){return"'+\n((__t=("+f(b)+"))==null?'':__t)+\n'"}).replace(d.evaluate||qa,function(a,b){return"';\n"+f(b)+";\n__p+='"})+"';\n";d.variable||(e="with(object||{}){\n"+e+"\n}\n"),e='var __t,__j=Array.prototype.join,__p="";function print(){__p+=__j.call(arguments,"")}\n'+e+"return __p";var g=Function(d.variable||"object","_",e);if(b)return g(b,c);var h=function(a){return g.call(this,a,c)};return h.source="function("+(d.variable||"object")+"){\n"+e+"\n}",h}function ia(a){return new d(a).chain()}function ja(){return this._chain=!0,this}function ka(){return this._wrapped}var la={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};!function(){for(var a in la)la[la[a]]=a}();var ma="object"==typeof exports&&exports&&("object"==typeof global&&global&&global==global.global&&(a=global),exports),na=0,oa=a._,pa=/\\|'|\r|\n|\t|\u2028|\u2029/g,qa=/.^/,ra=/\\(\\|'|r|n|t|u2028|u2029)/g,sa="[object Array]",ta="[object Boolean]",ua="[object Date]",va="[object Function]",wa="[object Number]",xa="[object RegExp]",ya="[object String]",za=Array.prototype,Aa=Object.prototype,Ba=za.concat,Ca=Aa.hasOwnProperty,Da=za.push,Ea=za.slice,Fa=Aa.toString,Ga=za.unshift,Ha=Array.isArray,Ia=a.isFinite,Ja=Object.keys,Ka=(a.clearInterval,a.setTimeout),La={args:"array",top:"var values=concat.apply([],slice.call(arguments,1))",init:"[]",inLoop:"if(indexOf(values,array[index])<0)result.push(array[index])"},Ma={init:"true",inLoop:"if(!callback(collection[index],index,collection))return !result"},Na={args:"object",init:"object",beforeLoop:"for(var source,j=1,length=arguments.length;j<length;j++){\nsource=arguments[j]",loopExp:"index in source",inLoop:"object[index]=source[index]",useHas:!1,afterLoop:"}"},Oa={init:"[]",inLoop:"callback(collection[index],index,collection)&&result.push(collection[index])"},Pa={args:"collection,callback,thisArg",top:"if(!callback){\ncallback=identity\n}\nelse if(thisArg){\ncallback=bind(callback,thisArg)\n}",init:"collection",inLoop:"callback(collection[index],index,collection)"},Qa={args:"object",top:"if(object!==Object(object))throw TypeError()",init:"[]",inLoop:"result.push(index)"},Ra={init:"",exits:"[]",beforeLoop:{array:"result=Array(length)",object:"result=[]"},inLoop:{array:"result[index]=callback(collection[index],index,collection)",object:"result[result.length]=callback(collection[index],index,collection)"}},Sa={top:"var current,result=-Infinity,computed=result;\nif(!callback){\nif(isArray(collection)&&collection[0]===+collection[0])return Math.max.apply(Math,collection);\nif(isEmpty(collection))return result;\n}else if(thisArg)callback=bind(callback,thisArg)",inLoop:"current=callback?callback(collection[index],index,collection):collection[index];\nif(current>=computed)computed=current,result=collection[index]"},Ta=Ha||function(a){return Fa.call(a)==sa},Ua=e({args:"value",iterate:"objects",top:"var className=toString.call(value)",init:"true",beforeLoop:"if(className==arrayClass||className==stringClass)return !value.length",inLoop:"return false"}),Va=e({args:"collection,target",init:"false",inLoop:"if(collection[index]===target)return true"}),Wa=e(Pa,Ma),Xa=e(Pa,Oa),Ya=e(Pa,{inLoop:"if(callback(collection[index],index,collection))return collection[index]"}),Za=e(Pa),$a=e(Pa,Ra),_a=e(Pa,Sa),ab=e(Pa,Sa,{top:Sa.top.replace("-","").replace("max","min"),inLoop:Sa.inLoop.replace(">=","<")}),bb=e(Ra,{args:"collection,property",inLoop:{array:"result[index]=collection[index][property]",object:"result[result.length]=collection[index][property]"}}),cb=e({args:"collection,callback,accumulator,thisArg",top:"var initial=arguments.length>2;\nif(thisArg)callback=bind(callback,thisArg)",init:"accumulator",beforeLoop:{array:"if(!initial)result=collection[++index]"},inLoop:{array:"result=callback(result,collection[index],index,collection)",object:"result=initial\n?callback(result,collection[index],index,collection)\n:(initial=true,collection[index])"}}),db=e(Pa,Oa,{inLoop:"!"+Oa.inLoop}),eb=e(Pa,Ma,{init:"false",inLoop:Ma.inLoop.replace("!","")}),fb=e(Ra,{args:"collection",inLoop:{array:"result[index]=collection[index]",object:"result[result.length]=collection[index]"}}),gb=e({args:"array",init:"[]",inLoop:"if(array[index])result.push(array[index])"}),hb=e(La),ib=e(La,{top:"var values=slice.call(arguments,1)",init:"[]"}),jb=e(Na,{inLoop:"if(object[index]==undefined)"+Na.inLoop}),kb=e(Na),lb=e(Qa,{top:"",useHas:!1,inLoop:"if(toString.call(object[index])==funcClass)result.push(index)",returns:"result.sort()"}),mb=function(a){return"[object Arguments]"==Fa.call(a)};mb(arguments)||(mb=function(a){return!(!a||!Ca.call(a,"callee"))});var nb=Ja||e(Qa);kb(c,{VERSION:"0.1.0",templateSettings:{escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},after:A,bind:B,bindAll:C,chain:ia,clone:L,compact:gb,compose:D,contains:Va,debounce:E,defaults:jb,defer:G,delay:F,difference:hb,escape:aa,every:Wa,extend:kb,filter:Xa,find:Ya,first:o,flatten:p,forEach:Za,functions:lb,groupBy:g,has:M,identity:ba,indexOf:q,initial:r,intersection:s,invoke:h,isArguments:mb,isArray:Ta,isBoolean:N,isDate:O,isElement:P,isEmpty:Ua,isEqual:Q,isFinite:R,isFunction:S,isNaN:U,isNull:V,isNumber:W,isObject:T,isRegExp:X,isString:Y,isUndefined:Z,keys:nb,last:t,lastIndexOf:u,map:$a,max:_a,memoize:H,min:ab,mixin:ca,noConflict:da,once:I,pick:$,pluck:bb,range:v,reduce:cb,reduceRight:i,reject:db,rest:w,result:ea,shuffle:j,size:k,some:eb,sortBy:l,sortedIndex:m,tap:_,template:ha,throttle:J,times:fa,toArray:n,union:x,uniq:y,uniqueId:ga,values:fb,without:ib,wrap:K,zip:z,all:Wa,any:eb,collect:$a,detect:Ya,each:Za,foldl:cb,foldr:i,head:o,include:Va,inject:cb,intersect:s,methods:lb,select:Xa,tail:w,take:o,unique:y}),d.prototype=c.prototype,ca(c),Za(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=za[a];c.prototype[a]=function(){var a=this._wrapped;return b.apply(a,arguments),0===a.length&&delete a[0],this._chain?new d(a).chain():a}}),Za(["concat","join","slice"],function(a){var b=za[a];d.prototype[a]=function(){var a=b.apply(this._wrapped,arguments);return this._chain?new d(a).chain():a}}),kb(d.prototype,{chain:ja,value:ka}),ma?"object"==typeof module&&module&&module.exports==ma?(module.exports=c)._=c:ma._=c:(a._=c,"function"==typeof define&&"object"==typeof define.amd&&define.amd&&define.amd.lodash&&define("lodash",function(){return c}))}(this),!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.io=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};a[g][0].call(j.exports,function(b){var c=a[g][1][b];return e(c?c:b)},j,j.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){b.exports=a("./lib/")},{"./lib/":2}],2:[function(a,b,c){function d(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d=e(a),f=d.source,j=d.id;return b.forceNew||b["force new connection"]||!1===b.multiplex?(h("ignoring socket cache for %s",f),c=g(f,b)):(i[j]||(h("new io instance for %s",f),i[j]=g(f,b)),c=i[j]),c.socket(d.path)}var e=a("./url"),f=a("socket.io-parser"),g=a("./manager"),h=a("debug")("socket.io-client");b.exports=c=d;var i=c.managers={};c.protocol=f.protocol,c.connect=d,c.Manager=a("./manager"),c.Socket=a("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":44}],3:[function(a,b,c){function d(a,b){return this instanceof d?(a&&"object"==typeof a&&(b=a,a=void 0),b=b||{},b.path=b.path||"/socket.io",this.nsps={},this.subs=[],this.opts=b,this.reconnection(b.reconnection!==!1),this.reconnectionAttempts(b.reconnectionAttempts||1/0),this.reconnectionDelay(b.reconnectionDelay||1e3),this.reconnectionDelayMax(b.reconnectionDelayMax||5e3),this.randomizationFactor(b.randomizationFactor||.5),this.backoff=new m({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==b.timeout?2e4:b.timeout),this.readyState="closed",this.uri=a,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new h.Encoder,this.decoder=new h.Decoder,this.autoConnect=b.autoConnect!==!1,void(this.autoConnect&&this.open())):new d(a,b)}var e=(a("./url"),a("engine.io-client")),f=a("./socket"),g=a("component-emitter"),h=a("socket.io-parser"),i=a("./on"),j=a("component-bind"),k=(a("object-component"),a("debug")("socket.io-client:manager")),l=a("indexof"),m=a("backo2");b.exports=d,d.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var a in this.nsps)this.nsps[a].emit.apply(this.nsps[a],arguments)},d.prototype.updateSocketIds=function(){for(var a in this.nsps)this.nsps[a].id=this.engine.id},g(d.prototype),d.prototype.reconnection=function(a){return arguments.length?(this._reconnection=!!a,this):this._reconnection},d.prototype.reconnectionAttempts=function(a){return arguments.length?(this._reconnectionAttempts=a,this):this._reconnectionAttempts},d.prototype.reconnectionDelay=function(a){return arguments.length?(this._reconnectionDelay=a,this.backoff&&this.backoff.setMin(a),this):this._reconnectionDelay},d.prototype.randomizationFactor=function(a){return arguments.length?(this._randomizationFactor=a,this.backoff&&this.backoff.setJitter(a),this):this._randomizationFactor},d.prototype.reconnectionDelayMax=function(a){return arguments.length?(this._reconnectionDelayMax=a,this.backoff&&this.backoff.setMax(a),this):this._reconnectionDelayMax},d.prototype.timeout=function(a){return arguments.length?(this._timeout=a,this):this._timeout},d.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},d.prototype.open=d.prototype.connect=function(a){if(k("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;k("opening %s",this.uri),this.engine=e(this.uri,this.opts);var b=this.engine,c=this;this.readyState="opening",this.skipReconnect=!1;var d=i(b,"open",function(){c.onopen(),a&&a()}),f=i(b,"error",function(b){if(k("connect_error"),c.cleanup(),c.readyState="closed",c.emitAll("connect_error",b),a){var d=new Error("Connection error");d.data=b,a(d)}else c.maybeReconnectOnOpen()});if(!1!==this._timeout){var g=this._timeout;k("connect attempt will timeout after %d",g);var h=setTimeout(function(){k("connect attempt timed out after %d",g),d.destroy(),b.close(),b.emit("error","timeout"),c.emitAll("connect_timeout",g)},g);this.subs.push({destroy:function(){clearTimeout(h)}})}return this.subs.push(d),this.subs.push(f),this},d.prototype.onopen=function(){k("open"),this.cleanup(),this.readyState="open",this.emit("open");var a=this.engine;this.subs.push(i(a,"data",j(this,"ondata"))),this.subs.push(i(this.decoder,"decoded",j(this,"ondecoded"))),this.subs.push(i(a,"error",j(this,"onerror"))),this.subs.push(i(a,"close",j(this,"onclose")))},d.prototype.ondata=function(a){this.decoder.add(a)},d.prototype.ondecoded=function(a){this.emit("packet",a)},d.prototype.onerror=function(a){k("error",a),this.emitAll("error",a)},d.prototype.socket=function(a){var b=this.nsps[a];if(!b){b=new f(this,a),this.nsps[a]=b;var c=this;b.on("connect",function(){b.id=c.engine.id,~l(c.connected,b)||c.connected.push(b)})}return b},d.prototype.destroy=function(a){var b=l(this.connected,a);~b&&this.connected.splice(b,1),this.connected.length||this.close()},d.prototype.packet=function(a){k("writing packet %j",a);var b=this;b.encoding?b.packetBuffer.push(a):(b.encoding=!0,this.encoder.encode(a,function(a){for(var c=0;c<a.length;c++)b.engine.write(a[c]);b.encoding=!1,b.processPacketQueue()}))},d.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var a=this.packetBuffer.shift();this.packet(a)}},d.prototype.cleanup=function(){for(var a;a=this.subs.shift();)a.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},d.prototype.close=d.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},d.prototype.onclose=function(a){k("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",a),this._reconnection&&!this.skipReconnect&&this.reconnect()},d.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)k("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var b=this.backoff.duration();k("will wait %dms before reconnect attempt",b),this.reconnecting=!0;var c=setTimeout(function(){a.skipReconnect||(k("attempting reconnect"),a.emitAll("reconnect_attempt",a.backoff.attempts),a.emitAll("reconnecting",a.backoff.attempts),a.skipReconnect||a.open(function(b){b?(k("reconnect attempt error"),a.reconnecting=!1,a.reconnect(),a.emitAll("reconnect_error",b.data)):(k("reconnect success"),a.onreconnect())}))},b);this.subs.push({destroy:function(){clearTimeout(c)}})}},d.prototype.onreconnect=function(){var a=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",a)}},{"./on":4,"./socket":5,"./url":6,backo2:7,"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:40,"object-component":41,"socket.io-parser":44}],4:[function(a,b,c){function d(a,b,c){return a.on(b,c),{destroy:function(){a.removeListener(b,c)}}}b.exports=d},{}],5:[function(a,b,c){function d(a,b){this.io=a,this.nsp=b,this.json=this,this.ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}var e=a("socket.io-parser"),f=a("component-emitter"),g=a("to-array"),h=a("./on"),i=a("component-bind"),j=a("debug")("socket.io-client:socket"),k=a("has-binary");b.exports=c=d;var l={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},m=f.prototype.emit;f(d.prototype),d.prototype.subEvents=function(){
if(!this.subs){var a=this.io;this.subs=[h(a,"open",i(this,"onopen")),h(a,"packet",i(this,"onpacket")),h(a,"close",i(this,"onclose"))]}},d.prototype.open=d.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this)},d.prototype.send=function(){var a=g(arguments);return a.unshift("message"),this.emit.apply(this,a),this},d.prototype.emit=function(a){if(l.hasOwnProperty(a))return m.apply(this,arguments),this;var b=g(arguments),c=e.EVENT;k(b)&&(c=e.BINARY_EVENT);var d={type:c,data:b};return"function"==typeof b[b.length-1]&&(j("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),d.id=this.ids++),this.connected?this.packet(d):this.sendBuffer.push(d),this},d.prototype.packet=function(a){a.nsp=this.nsp,this.io.packet(a)},d.prototype.onopen=function(){j("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:e.CONNECT})},d.prototype.onclose=function(a){j("close (%s)",a),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",a)},d.prototype.onpacket=function(a){if(a.nsp==this.nsp)switch(a.type){case e.CONNECT:this.onconnect();break;case e.EVENT:this.onevent(a);break;case e.BINARY_EVENT:this.onevent(a);break;case e.ACK:this.onack(a);break;case e.BINARY_ACK:this.onack(a);break;case e.DISCONNECT:this.ondisconnect();break;case e.ERROR:this.emit("error",a.data)}},d.prototype.onevent=function(a){var b=a.data||[];j("emitting event %j",b),null!=a.id&&(j("attaching ack callback to event"),b.push(this.ack(a.id))),this.connected?m.apply(this,b):this.receiveBuffer.push(b)},d.prototype.ack=function(a){var b=this,c=!1;return function(){if(!c){c=!0;var d=g(arguments);j("sending ack %j",d);var f=k(d)?e.BINARY_ACK:e.ACK;b.packet({type:f,id:a,data:d})}}},d.prototype.onack=function(a){j("calling ack %s with %j",a.id,a.data);var b=this.acks[a.id];b.apply(this,a.data),delete this.acks[a.id]},d.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},d.prototype.emitBuffered=function(){var a;for(a=0;a<this.receiveBuffer.length;a++)m.apply(this,this.receiveBuffer[a]);for(this.receiveBuffer=[],a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);this.sendBuffer=[]},d.prototype.ondisconnect=function(){j("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},d.prototype.destroy=function(){if(this.subs){for(var a=0;a<this.subs.length;a++)this.subs[a].destroy();this.subs=null}this.io.destroy(this)},d.prototype.close=d.prototype.disconnect=function(){return this.connected&&(j("performing disconnect (%s)",this.nsp),this.packet({type:e.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":36,"socket.io-parser":44,"to-array":48}],6:[function(a,b,c){(function(c){function d(a,b){var d=a,b=b||c.location;return null==a&&(a=b.protocol+"//"+b.host),"string"==typeof a&&("/"==a.charAt(0)&&(a="/"==a.charAt(1)?b.protocol+a:b.hostname+a),/^(https?|wss?):\/\//.test(a)||(f("protocol-less url %s",a),a="undefined"!=typeof b?b.protocol+"//"+a:"https://"+a),f("parse %s",a),d=e(a)),d.port||(/^(http|ws)$/.test(d.protocol)?d.port="80":/^(http|ws)s$/.test(d.protocol)&&(d.port="443")),d.path=d.path||"/",d.id=d.protocol+"://"+d.host+":"+d.port,d.href=d.protocol+"://"+d.host+(b&&b.port==d.port?"":":"+d.port),d}var e=a("parseuri"),f=a("debug")("socket.io-client:url");b.exports=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:10,parseuri:42}],7:[function(a,b,c){function d(a){a=a||{},this.ms=a.min||100,this.max=a.max||1e4,this.factor=a.factor||2,this.jitter=a.jitter>0&&a.jitter<=1?a.jitter:0,this.attempts=0}b.exports=d,d.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),c=Math.floor(b*this.jitter*a);a=0==(1&Math.floor(10*b))?a-c:a+c}return 0|Math.min(a,this.max)},d.prototype.reset=function(){this.attempts=0},d.prototype.setMin=function(a){this.ms=a},d.prototype.setMax=function(a){this.max=a},d.prototype.setJitter=function(a){this.jitter=a}},{}],8:[function(a,b,c){var d=[].slice;b.exports=function(a,b){if("string"==typeof b&&(b=a[b]),"function"!=typeof b)throw new Error("bind() requires a function");var c=d.call(arguments,2);return function(){return b.apply(a,c.concat(d.call(arguments)))}}},{}],9:[function(a,b,c){function d(a){return a?e(a):void 0}function e(a){for(var b in d.prototype)a[b]=d.prototype[b];return a}b.exports=d,d.prototype.on=d.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks[a]=this._callbacks[a]||[]).push(b),this},d.prototype.once=function(a,b){function c(){d.off(a,c),b.apply(this,arguments)}var d=this;return this._callbacks=this._callbacks||{},c.fn=b,this.on(a,c),this},d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=d.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c=this._callbacks[a];if(!c)return this;if(1==arguments.length)return delete this._callbacks[a],this;for(var d,e=0;e<c.length;e++)if(d=c[e],d===b||d.fn===b){c.splice(e,1);break}return this},d.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c){c=c.slice(0);for(var d=0,e=c.length;e>d;++d)c[d].apply(this,b)}return this},d.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks[a]||[]},d.prototype.hasListeners=function(a){return!!this.listeners(a).length}},{}],10:[function(a,b,c){function d(a){return d.enabled(a)?function(b){b=e(b);var c=new Date,f=c-(d[a]||c);d[a]=c,b=a+" "+b+" +"+d.humanize(f),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function e(a){return a instanceof Error?a.stack||a.message:a}b.exports=d,d.names=[],d.skips=[],d.enable=function(a){try{localStorage.debug=a}catch(b){}for(var c=(a||"").split(/[\s,]+/),e=c.length,f=0;e>f;f++)a=c[f].replace("*",".*?"),"-"===a[0]?d.skips.push(new RegExp("^"+a.substr(1)+"$")):d.names.push(new RegExp("^"+a+"$"))},d.disable=function(){d.enable("")},d.humanize=function(a){var b=1e3,c=6e4,d=60*c;return a>=d?(a/d).toFixed(1)+"h":a>=c?(a/c).toFixed(1)+"m":a>=b?(a/b|0)+"s":a+"ms"},d.enabled=function(a){for(var b=0,c=d.skips.length;c>b;b++)if(d.skips[b].test(a))return!1;for(var b=0,c=d.names.length;c>b;b++)if(d.names[b].test(a))return!0;return!1};try{window.localStorage&&d.enable(localStorage.debug)}catch(f){}},{}],11:[function(a,b,c){b.exports=a("./lib/")},{"./lib/":12}],12:[function(a,b,c){b.exports=a("./socket"),b.exports.parser=a("engine.io-parser")},{"./socket":13,"engine.io-parser":25}],13:[function(a,b,c){(function(c){function d(a,b){if(!(this instanceof d))return new d(a,b);if(b=b||{},a&&"object"==typeof a&&(b=a,a=null),a&&(a=k(a),b.host=a.host,b.secure="https"==a.protocol||"wss"==a.protocol,b.port=a.port,a.query&&(b.query=a.query)),this.secure=null!=b.secure?b.secure:c.location&&"https:"==location.protocol,b.host){var e=b.host.split(":");b.hostname=e.shift(),e.length?b.port=e.pop():b.port||(b.port=this.secure?"443":"80")}this.agent=b.agent||!1,this.hostname=b.hostname||(c.location?location.hostname:"localhost"),this.port=b.port||(c.location&&location.port?location.port:this.secure?443:80),this.query=b.query||{},"string"==typeof this.query&&(this.query=m.decode(this.query)),this.upgrade=!1!==b.upgrade,this.path=(b.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!b.forceJSONP,this.jsonp=!1!==b.jsonp,this.forceBase64=!!b.forceBase64,this.enablesXDR=!!b.enablesXDR,this.timestampParam=b.timestampParam||"t",this.timestampRequests=b.timestampRequests,this.transports=b.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=b.policyPort||843,this.rememberUpgrade=b.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=b.onlyBinaryUpgrades,this.pfx=b.pfx||null,this.key=b.key||null,this.passphrase=b.passphrase||null,this.cert=b.cert||null,this.ca=b.ca||null,this.ciphers=b.ciphers||null,this.rejectUnauthorized=b.rejectUnauthorized||null,this.open()}function e(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}var f=a("./transports"),g=a("component-emitter"),h=a("debug")("engine.io-client:socket"),i=a("indexof"),j=a("engine.io-parser"),k=a("parseuri"),l=a("parsejson"),m=a("parseqs");b.exports=d,d.priorWebsocketSuccess=!1,g(d.prototype),d.protocol=j.protocol,d.Socket=d,d.Transport=a("./transport"),d.transports=a("./transports"),d.parser=a("engine.io-parser"),d.prototype.createTransport=function(a){h('creating transport "%s"',a);var b=e(this.query);b.EIO=j.protocol,b.transport=a,this.id&&(b.sid=this.id);var c=new f[a]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:b,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized});return c},d.prototype.open=function(){var a;if(this.rememberUpgrade&&d.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))a="websocket";else{if(0==this.transports.length){var b=this;return void setTimeout(function(){b.emit("error","No transports available")},0)}a=this.transports[0]}this.readyState="opening";var a;try{a=this.createTransport(a)}catch(c){return this.transports.shift(),void this.open()}a.open(),this.setTransport(a)},d.prototype.setTransport=function(a){h("setting transport %s",a.name);var b=this;this.transport&&(h("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=a,a.on("drain",function(){b.onDrain()}).on("packet",function(a){b.onPacket(a)}).on("error",function(a){b.onError(a)}).on("close",function(){b.onClose("transport close")})},d.prototype.probe=function(a){function b(){if(m.onlyBinaryUpgrades){var b=!this.supportsBinary&&m.transport.supportsBinary;l=l||b}l||(h('probe transport "%s" opened',a),k.send([{type:"ping",data:"probe"}]),k.once("packet",function(b){if(!l)if("pong"==b.type&&"probe"==b.data){if(h('probe transport "%s" pong',a),m.upgrading=!0,m.emit("upgrading",k),!k)return;d.priorWebsocketSuccess="websocket"==k.name,h('pausing current transport "%s"',m.transport.name),m.transport.pause(function(){l||"closed"!=m.readyState&&(h("changing transport and sending upgrade packet"),j(),m.setTransport(k),k.send([{type:"upgrade"}]),m.emit("upgrade",k),k=null,m.upgrading=!1,m.flush())})}else{h('probe transport "%s" failed',a);var c=new Error("probe error");c.transport=k.name,m.emit("upgradeError",c)}}))}function c(){l||(l=!0,j(),k.close(),k=null)}function e(b){var d=new Error("probe error: "+b);d.transport=k.name,c(),h('probe transport "%s" failed because of error: %s',a,b),m.emit("upgradeError",d)}function f(){e("transport closed")}function g(){e("socket closed")}function i(a){k&&a.name!=k.name&&(h('"%s" works - aborting "%s"',a.name,k.name),c())}function j(){k.removeListener("open",b),k.removeListener("error",e),k.removeListener("close",f),m.removeListener("close",g),m.removeListener("upgrading",i)}h('probing transport "%s"',a);var k=this.createTransport(a,{probe:1}),l=!1,m=this;d.priorWebsocketSuccess=!1,k.once("open",b),k.once("error",e),k.once("close",f),this.once("close",g),this.once("upgrading",i),k.open()},d.prototype.onOpen=function(){if(h("socket open"),this.readyState="open",d.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){h("starting upgrade probes");for(var a=0,b=this.upgrades.length;b>a;a++)this.probe(this.upgrades[a])}},d.prototype.onPacket=function(a){if("opening"==this.readyState||"open"==this.readyState)switch(h('socket receive: type "%s", data "%s"',a.type,a.data),this.emit("packet",a),this.emit("heartbeat"),a.type){case"open":this.onHandshake(l(a.data));break;case"pong":this.setPing();break;case"error":var b=new Error("server error");b.code=a.data,this.emit("error",b);break;case"message":this.emit("data",a.data),this.emit("message",a.data)}else h('packet received with socket readyState "%s"',this.readyState)},d.prototype.onHandshake=function(a){this.emit("handshake",a),this.id=a.sid,this.transport.query.sid=a.sid,this.upgrades=this.filterUpgrades(a.upgrades),this.pingInterval=a.pingInterval,this.pingTimeout=a.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},d.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);var b=this;b.pingTimeoutTimer=setTimeout(function(){"closed"!=b.readyState&&b.onClose("ping timeout")},a||b.pingInterval+b.pingTimeout)},d.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer),a.pingIntervalTimer=setTimeout(function(){h("writing ping packet - expecting pong within %sms",a.pingTimeout),a.ping(),a.onHeartbeat(a.pingTimeout)},a.pingInterval)},d.prototype.ping=function(){this.sendPacket("ping")},d.prototype.onDrain=function(){for(var a=0;a<this.prevBufferLen;a++)this.callbackBuffer[a]&&this.callbackBuffer[a]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0==this.writeBuffer.length?this.emit("drain"):this.flush()},d.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(h("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},d.prototype.write=d.prototype.send=function(a,b){return this.sendPacket("message",a,b),this},d.prototype.sendPacket=function(a,b,c){if("closing"!=this.readyState&&"closed"!=this.readyState){var d={type:a,data:b};this.emit("packetCreate",d),this.writeBuffer.push(d),this.callbackBuffer.push(c),this.flush()}},d.prototype.close=function(){function a(){d.onClose("forced close"),h("socket closing - telling transport to close"),d.transport.close()}function b(){d.removeListener("upgrade",b),d.removeListener("upgradeError",b),a()}function c(){d.once("upgrade",b),d.once("upgradeError",b)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var d=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?c():a()}):this.upgrading?c():a()}return this},d.prototype.onError=function(a){h("socket error %j",a),d.priorWebsocketSuccess=!1,this.emit("error",a),this.onClose("transport error",a)},d.prototype.onClose=function(a,b){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){h('socket close with reason: "%s"',a);var c=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){c.writeBuffer=[],c.callbackBuffer=[],c.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",a,b)}},d.prototype.filterUpgrades=function(a){for(var b=[],c=0,d=a.length;d>c;c++)~i(this.transports,a[c])&&b.push(a[c]);return b}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":9,debug:22,"engine.io-parser":25,indexof:40,parsejson:32,parseqs:33,parseuri:34}],14:[function(a,b,c){function d(a){this.path=a.path,this.hostname=a.hostname,this.port=a.port,this.secure=a.secure,this.query=a.query,this.timestampParam=a.timestampParam,this.timestampRequests=a.timestampRequests,this.readyState="",this.agent=a.agent||!1,this.socket=a.socket,this.enablesXDR=a.enablesXDR,this.pfx=a.pfx,this.key=a.key,this.passphrase=a.passphrase,this.cert=a.cert,this.ca=a.ca,this.ciphers=a.ciphers,this.rejectUnauthorized=a.rejectUnauthorized}var e=a("engine.io-parser"),f=a("component-emitter");b.exports=d,f(d.prototype),d.timestamps=0,d.prototype.onError=function(a,b){var c=new Error(a);return c.type="TransportError",c.description=b,this.emit("error",c),this},d.prototype.open=function(){return("closed"==this.readyState||""==this.readyState)&&(this.readyState="opening",this.doOpen()),this},d.prototype.close=function(){return("opening"==this.readyState||"open"==this.readyState)&&(this.doClose(),this.onClose()),this},d.prototype.send=function(a){if("open"!=this.readyState)throw new Error("Transport not open");this.write(a)},d.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},d.prototype.onData=function(a){var b=e.decodePacket(a,this.socket.binaryType);this.onPacket(b)},d.prototype.onPacket=function(a){this.emit("packet",a)},d.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":9,"engine.io-parser":25}],15:[function(a,b,c){(function(b){function d(a){var c,d=!1,h=!1,i=!1!==a.jsonp;if(b.location){var j="https:"==location.protocol,k=location.port;k||(k=j?443:80),d=a.hostname!=location.hostname||k!=a.port,h=a.secure!=j}if(a.xdomain=d,a.xscheme=h,c=new e(a),"open"in c&&!a.forceJSONP)return new f(a);if(!i)throw new Error("JSONP disabled");return new g(a)}var e=a("xmlhttprequest"),f=a("./polling-xhr"),g=a("./polling-jsonp"),h=a("./websocket");c.polling=d,c.websocket=h}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(a,b,c){(function(c){function d(){}function e(a){f.call(this,a),this.query=this.query||{},h||(c.___eio||(c.___eio=[]),h=c.___eio),this.index=h.length;var b=this;h.push(function(a){b.onData(a)}),this.query.j=this.index,c.document&&c.addEventListener&&c.addEventListener("beforeunload",function(){b.script&&(b.script.onerror=d)},!1)}var f=a("./polling"),g=a("component-inherit");b.exports=e;var h,i=/\n/g,j=/\\n/g;g(e,f),e.prototype.supportsBinary=!1,e.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),f.prototype.doClose.call(this)},e.prototype.doPoll=function(){var a=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),b.async=!0,b.src=this.uri(),b.onerror=function(b){a.onError("jsonp poll error",b)};var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c),this.script=b;var d="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);d&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a),document.body.removeChild(a)},100)},e.prototype.doWrite=function(a,b){function c(){d(),b()}function d(){if(e.iframe)try{e.form.removeChild(e.iframe)}catch(a){e.onError("jsonp polling iframe removal error",a)}try{var b='<iframe src="javascript:0" name="'+e.iframeId+'">';f=document.createElement(b)}catch(a){f=document.createElement("iframe"),f.name=e.iframeId,f.src="javascript:0"}f.id=e.iframeId,e.form.appendChild(f),e.iframe=f}var e=this;if(!this.form){var f,g=document.createElement("form"),h=document.createElement("textarea"),k=this.iframeId="eio_iframe_"+this.index;g.className="socketio",g.style.position="absolute",g.style.top="-1000px",g.style.left="-1000px",g.target=k,g.method="POST",g.setAttribute("accept-charset","utf-8"),h.name="d",g.appendChild(h),document.body.appendChild(g),this.form=g,this.area=h}this.form.action=this.uri(),d(),a=a.replace(j,"\\\n"),this.area.value=a.replace(i,"\\n");try{this.form.submit()}catch(l){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==e.iframe.readyState&&c()}:this.iframe.onload=c}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-inherit":21}],17:[function(a,b,c){(function(c){function d(){}function e(a){if(i.call(this,a),c.location){var b="https:"==location.protocol,d=location.port;d||(d=b?443:80),this.xd=a.hostname!=c.location.hostname||d!=a.port,this.xs=a.secure!=b}}function f(a){this.method=a.method||"GET",this.uri=a.uri,this.xd=!!a.xd,this.xs=!!a.xs,this.async=!1!==a.async,this.data=void 0!=a.data?a.data:null,this.agent=a.agent,this.isBinary=a.isBinary,this.supportsBinary=a.supportsBinary,this.enablesXDR=a.enablesXDR,this.pfx=a.pfx,this.key=a.key,this.passphrase=a.passphrase,this.cert=a.cert,this.ca=a.ca,this.ciphers=a.ciphers,this.rejectUnauthorized=a.rejectUnauthorized,this.create()}function g(){for(var a in f.requests)f.requests.hasOwnProperty(a)&&f.requests[a].abort()}var h=a("xmlhttprequest"),i=a("./polling"),j=a("component-emitter"),k=a("component-inherit"),l=a("debug")("engine.io-client:polling-xhr");b.exports=e,b.exports.Request=f,k(e,i),e.prototype.supportsBinary=!0,e.prototype.request=function(a){return a=a||{},a.uri=this.uri(),a.xd=this.xd,a.xs=this.xs,a.agent=this.agent||!1,a.supportsBinary=this.supportsBinary,a.enablesXDR=this.enablesXDR,a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized,new f(a)},e.prototype.doWrite=function(a,b){var c="string"!=typeof a&&void 0!==a,d=this.request({method:"POST",data:a,isBinary:c}),e=this;d.on("success",b),d.on("error",function(a){e.onError("xhr post error",a)}),this.sendXhr=d},e.prototype.doPoll=function(){l("xhr poll");var a=this.request(),b=this;a.on("data",function(a){b.onData(a)}),a.on("error",function(a){b.onError("xhr poll error",a)}),this.pollXhr=a},j(f.prototype),f.prototype.create=function(){var a={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized;var b=this.xhr=new h(a),d=this;try{if(l("xhr open %s: %s",this.method,this.uri),b.open(this.method,this.uri,this.async),this.supportsBinary&&(b.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?b.setRequestHeader("Content-type","application/octet-stream"):b.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}"withCredentials"in b&&(b.withCredentials=!0),this.hasXDR()?(b.onload=function(){d.onLoad()},b.onerror=function(){d.onError(b.responseText)}):b.onreadystatechange=function(){4==b.readyState&&(200==b.status||1223==b.status?d.onLoad():setTimeout(function(){d.onError(b.status)},0))},l("xhr data %s",this.data),b.send(this.data)}catch(e){return void setTimeout(function(){d.onError(e)},0)}c.document&&(this.index=f.requestsCount++,f.requests[this.index]=this)},f.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},f.prototype.onData=function(a){this.emit("data",a),this.onSuccess()},f.prototype.onError=function(a){this.emit("error",a),this.cleanup(!0)},f.prototype.cleanup=function(a){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=d:this.xhr.onreadystatechange=d,a)try{this.xhr.abort()}catch(b){}c.document&&delete f.requests[this.index],this.xhr=null}},f.prototype.onLoad=function(){var a;try{var b;try{b=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(c){}a="application/octet-stream"===b?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(c){this.onError(c)}null!=a&&this.onData(a)},f.prototype.hasXDR=function(){return"undefined"!=typeof c.XDomainRequest&&!this.xs&&this.enablesXDR},f.prototype.abort=function(){this.cleanup()},c.document&&(f.requestsCount=0,f.requests={},c.attachEvent?c.attachEvent("onunload",g):c.addEventListener&&c.addEventListener("beforeunload",g,!1))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(a,b,c){function d(a){var b=a&&a.forceBase64;(!j||b)&&(this.supportsBinary=!1),e.call(this,a)}var e=a("../transport"),f=a("parseqs"),g=a("engine.io-parser"),h=a("component-inherit"),i=a("debug")("engine.io-client:polling");b.exports=d;var j=function(){var b=a("xmlhttprequest"),c=new b({xdomain:!1});return null!=c.responseType}();h(d,e),d.prototype.name="polling",d.prototype.doOpen=function(){this.poll()},d.prototype.pause=function(a){function b(){i("paused"),c.readyState="paused",a()}var c=this;if(this.readyState="pausing",this.polling||!this.writable){var d=0;this.polling&&(i("we are currently polling - waiting to pause"),d++,this.once("pollComplete",function(){i("pre-pause polling complete"),--d||b()})),this.writable||(i("we are currently writing - waiting to pause"),d++,this.once("drain",function(){i("pre-pause writing complete"),--d||b()}))}else b()},d.prototype.poll=function(){i("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},d.prototype.onData=function(a){var b=this;i("polling got data %s",a);var c=function(a,c,d){return"opening"==b.readyState&&b.onOpen(),"close"==a.type?(b.onClose(),!1):void b.onPacket(a)};g.decodePayload(a,this.socket.binaryType,c),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():i('ignoring poll - transport state "%s"',this.readyState))},d.prototype.doClose=function(){function a(){i("writing close packet"),b.write([{type:"close"}])}var b=this;"open"==this.readyState?(i("transport open - closing"),a()):(i("transport not open - deferring close"),this.once("open",a))},d.prototype.write=function(a){var b=this;this.writable=!1;var c=function(){b.writable=!0,b.emit("drain")},b=this;g.encodePayload(a,this.supportsBinary,function(a){b.doWrite(a,c)})},d.prototype.uri=function(){var a=this.query||{},b=this.secure?"https":"http",c="";return!1!==this.timestampRequests&&(a[this.timestampParam]=+new Date+"-"+e.timestamps++),this.supportsBinary||a.sid||(a.b64=1),a=f.encode(a),this.port&&("https"==b&&443!=this.port||"http"==b&&80!=this.port)&&(c=":"+this.port),a.length&&(a="?"+a),b+"://"+this.hostname+c+this.path+a}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:33,xmlhttprequest:20}],19:[function(a,b,c){function d(a){var b=a&&a.forceBase64;b&&(this.supportsBinary=!1),e.call(this,a)}var e=a("../transport"),f=a("engine.io-parser"),g=a("parseqs"),h=a("component-inherit"),i=a("debug")("engine.io-client:websocket"),j=a("ws");b.exports=d,h(d,e),d.prototype.name="websocket",d.prototype.supportsBinary=!0,d.prototype.doOpen=function(){if(this.check()){var a=this.uri(),b=void 0,c={agent:this.agent};c.pfx=this.pfx,c.key=this.key,c.passphrase=this.passphrase,c.cert=this.cert,c.ca=this.ca,c.ciphers=this.ciphers,c.rejectUnauthorized=this.rejectUnauthorized,this.ws=new j(a,b,c),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()}},d.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.onOpen()},this.ws.onclose=function(){a.onClose()},this.ws.onmessage=function(b){a.onData(b.data)},this.ws.onerror=function(b){a.onError("websocket error",b)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(d.prototype.onData=function(a){var b=this;setTimeout(function(){e.prototype.onData.call(b,a)},0)}),d.prototype.write=function(a){function b(){c.writable=!0,c.emit("drain")}var c=this;this.writable=!1;for(var d=0,e=a.length;e>d;d++)f.encodePacket(a[d],this.supportsBinary,function(a){try{c.ws.send(a)}catch(b){i("websocket closed before onclose event")}});setTimeout(b,0)},d.prototype.onClose=function(){e.prototype.onClose.call(this)},d.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},d.prototype.uri=function(){var a=this.query||{},b=this.secure?"wss":"ws",c="";return this.port&&("wss"==b&&443!=this.port||"ws"==b&&80!=this.port)&&(c=":"+this.port),this.timestampRequests&&(a[this.timestampParam]=+new Date),this.supportsBinary||(a.b64=1),a=g.encode(a),a.length&&(a="?"+a),b+"://"+this.hostname+c+this.path+a},d.prototype.check=function(){return!(!j||"__initialize"in j&&this.name===d.prototype.name)}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:33,ws:35}],20:[function(a,b,c){var d=a("has-cors");b.exports=function(a){var b=a.xdomain,c=a.xscheme,e=a.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!b||d))return new XMLHttpRequest}catch(f){}try{if("undefined"!=typeof XDomainRequest&&!c&&e)return new XDomainRequest}catch(f){}if(!b)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(f){}}},{"has-cors":38}],21:[function(a,b,c){b.exports=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],22:[function(a,b,c){function d(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function e(){var a=arguments,b=this.useColors;if(a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+c.humanize(this.diff),!b)return a;var d="color: "+this.color;a=[a[0],d,"color: inherit"].concat(Array.prototype.slice.call(a,1));var e=0,f=0;return a[0].replace(/%[a-z%]/g,function(a){"%%"!==a&&(e++,"%c"===a&&(f=e))}),a.splice(f,0,d),a}function f(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function g(a){try{null==a?localStorage.removeItem("debug"):localStorage.debug=a}catch(b){}}function h(){var a;try{a=localStorage.debug}catch(b){}return a}c=b.exports=a("./debug"),c.log=f,c.formatArgs=e,c.save=g,c.load=h,c.useColors=d,c.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],c.formatters.j=function(a){return JSON.stringify(a)},c.enable(h())},{"./debug":23}],23:[function(a,b,c){function d(){return c.colors[k++%c.colors.length]}function e(a){function b(){}function e(){var a=e,b=+new Date,f=b-(j||b);a.diff=f,a.prev=j,a.curr=b,j=b,null==a.useColors&&(a.useColors=c.useColors()),null==a.color&&a.useColors&&(a.color=d());var g=Array.prototype.slice.call(arguments);g[0]=c.coerce(g[0]),"string"!=typeof g[0]&&(g=["%o"].concat(g));var h=0;g[0]=g[0].replace(/%([a-z%])/g,function(b,d){if("%%"===b)return b;h++;var e=c.formatters[d];if("function"==typeof e){var f=g[h];b=e.call(a,f),g.splice(h,1),h--}return b}),"function"==typeof c.formatArgs&&(g=c.formatArgs.apply(a,g));var i=e.log||c.log||console.log.bind(console);i.apply(a,g)}b.enabled=!1,e.enabled=!0;var f=c.enabled(a)?e:b;return f.namespace=a,f}function f(a){c.save(a);for(var b=(a||"").split(/[\s,]+/),d=b.length,e=0;d>e;e++)b[e]&&(a=b[e].replace(/\*/g,".*?"),"-"===a[0]?c.skips.push(new RegExp("^"+a.substr(1)+"$")):c.names.push(new RegExp("^"+a+"$")))}function g(){c.enable("")}function h(a){var b,d;for(b=0,d=c.skips.length;d>b;b++)if(c.skips[b].test(a))return!1;for(b=0,d=c.names.length;d>b;b++)if(c.names[b].test(a))return!0;return!1}function i(a){return a instanceof Error?a.stack||a.message:a}c=b.exports=e,c.coerce=i,c.disable=g,c.enable=f,c.enabled=h,c.humanize=a("ms"),c.names=[],c.skips=[],c.formatters={};var j,k=0},{ms:24}],24:[function(a,b,c){function d(a){var b=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(a);if(b){var c=parseFloat(b[1]),d=(b[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"y":return c*l;case"days":case"day":case"d":return c*k;case"hours":case"hour":case"h":return c*j;case"minutes":case"minute":case"m":return c*i;case"seconds":case"second":case"s":return c*h;case"ms":return c}}}function e(a){return a>=k?Math.round(a/k)+"d":a>=j?Math.round(a/j)+"h":a>=i?Math.round(a/i)+"m":a>=h?Math.round(a/h)+"s":a+"ms"}function f(a){return g(a,k,"day")||g(a,j,"hour")||g(a,i,"minute")||g(a,h,"second")||a+" ms";
}function g(a,b,c){return b>a?void 0:1.5*b>a?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var h=1e3,i=60*h,j=60*i,k=24*j,l=365.25*k;b.exports=function(a,b){return b=b||{},"string"==typeof a?d(a):b["long"]?f(a):e(a)}},{}],25:[function(a,b,c){(function(b){function d(a,b){var d="b"+c.packets[a.type]+a.data.data;return b(d)}function e(a,b,d){if(!b)return c.encodeBase64Packet(a,d);var e=a.data,f=new Uint8Array(e),g=new Uint8Array(1+e.byteLength);g[0]=r[a.type];for(var h=0;h<f.length;h++)g[h+1]=f[h];return d(g.buffer)}function f(a,b,d){if(!b)return c.encodeBase64Packet(a,d);var e=new FileReader;return e.onload=function(){a.data=e.result,c.encodePacket(a,b,!0,d)},e.readAsArrayBuffer(a.data)}function g(a,b,d){if(!b)return c.encodeBase64Packet(a,d);if(q)return f(a,b,d);var e=new Uint8Array(1);e[0]=r[a.type];var g=new u([e.buffer,a.data]);return d(g)}function h(a,b,c){for(var d=new Array(a.length),e=m(a.length,c),f=function(a,c,e){b(c,function(b,c){d[a]=c,e(b,d)})},g=0;g<a.length;g++)f(g,a[g],e)}var i=a("./keys"),j=a("has-binary"),k=a("arraybuffer.slice"),l=a("base64-arraybuffer"),m=a("after"),n=a("utf8"),o=navigator.userAgent.match(/Android/i),p=/PhantomJS/i.test(navigator.userAgent),q=o||p;c.protocol=3;var r=c.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},s=i(r),t={type:"error",data:"parser error"},u=a("blob");c.encodePacket=function(a,c,f,h){"function"==typeof c&&(h=c,c=!1),"function"==typeof f&&(h=f,f=null);var i=void 0===a.data?void 0:a.data.buffer||a.data;if(b.ArrayBuffer&&i instanceof ArrayBuffer)return e(a,c,h);if(u&&i instanceof b.Blob)return g(a,c,h);if(i&&i.base64)return d(a,h);var j=r[a.type];return void 0!==a.data&&(j+=f?n.encode(String(a.data)):String(a.data)),h(""+j)},c.encodeBase64Packet=function(a,d){var e="b"+c.packets[a.type];if(u&&a.data instanceof u){var f=new FileReader;return f.onload=function(){var a=f.result.split(",")[1];d(e+a)},f.readAsDataURL(a.data)}var g;try{g=String.fromCharCode.apply(null,new Uint8Array(a.data))}catch(h){for(var i=new Uint8Array(a.data),j=new Array(i.length),k=0;k<i.length;k++)j[k]=i[k];g=String.fromCharCode.apply(null,j)}return e+=b.btoa(g),d(e)},c.decodePacket=function(a,b,d){if("string"==typeof a||void 0===a){if("b"==a.charAt(0))return c.decodeBase64Packet(a.substr(1),b);if(d)try{a=n.decode(a)}catch(e){return t}var f=a.charAt(0);return Number(f)==f&&s[f]?a.length>1?{type:s[f],data:a.substring(1)}:{type:s[f]}:t}var g=new Uint8Array(a),f=g[0],h=k(a,1);return u&&"blob"===b&&(h=new u([h])),{type:s[f],data:h}},c.decodeBase64Packet=function(a,c){var d=s[a.charAt(0)];if(!b.ArrayBuffer)return{type:d,data:{base64:!0,data:a.substr(1)}};var e=l.decode(a.substr(1));return"blob"===c&&u&&(e=new u([e])),{type:d,data:e}},c.encodePayload=function(a,b,d){function e(a){return a.length+":"+a}function f(a,d){c.encodePacket(a,g?b:!1,!0,function(a){d(null,e(a))})}"function"==typeof b&&(d=b,b=null);var g=j(a);return b&&g?u&&!q?c.encodePayloadAsBlob(a,d):c.encodePayloadAsArrayBuffer(a,d):a.length?void h(a,f,function(a,b){return d(b.join(""))}):d("0:")},c.decodePayload=function(a,b,d){if("string"!=typeof a)return c.decodePayloadAsBinary(a,b,d);"function"==typeof b&&(d=b,b=null);var e;if(""==a)return d(t,0,1);for(var f,g,h="",i=0,j=a.length;j>i;i++){var k=a.charAt(i);if(":"!=k)h+=k;else{if(""==h||h!=(f=Number(h)))return d(t,0,1);if(g=a.substr(i+1,f),h!=g.length)return d(t,0,1);if(g.length){if(e=c.decodePacket(g,b,!0),t.type==e.type&&t.data==e.data)return d(t,0,1);var l=d(e,i+f,j);if(!1===l)return}i+=f,h=""}}return""!=h?d(t,0,1):void 0},c.encodePayloadAsArrayBuffer=function(a,b){function d(a,b){c.encodePacket(a,!0,!0,function(a){return b(null,a)})}return a.length?void h(a,d,function(a,c){var d=c.reduce(function(a,b){var c;return c="string"==typeof b?b.length:b.byteLength,a+c.toString().length+c+2},0),e=new Uint8Array(d),f=0;return c.forEach(function(a){var b="string"==typeof a,c=a;if(b){for(var d=new Uint8Array(a.length),g=0;g<a.length;g++)d[g]=a.charCodeAt(g);c=d.buffer}b?e[f++]=0:e[f++]=1;for(var h=c.byteLength.toString(),g=0;g<h.length;g++)e[f++]=parseInt(h[g]);e[f++]=255;for(var d=new Uint8Array(c),g=0;g<d.length;g++)e[f++]=d[g]}),b(e.buffer)}):b(new ArrayBuffer(0))},c.encodePayloadAsBlob=function(a,b){function d(a,b){c.encodePacket(a,!0,!0,function(a){var c=new Uint8Array(1);if(c[0]=1,"string"==typeof a){for(var d=new Uint8Array(a.length),e=0;e<a.length;e++)d[e]=a.charCodeAt(e);a=d.buffer,c[0]=0}for(var f=a instanceof ArrayBuffer?a.byteLength:a.size,g=f.toString(),h=new Uint8Array(g.length+1),e=0;e<g.length;e++)h[e]=parseInt(g[e]);if(h[g.length]=255,u){var i=new u([c.buffer,h.buffer,a]);b(null,i)}})}h(a,d,function(a,c){return b(new u(c))})},c.decodePayloadAsBinary=function(a,b,d){"function"==typeof b&&(d=b,b=null);for(var e=a,f=[],g=!1;e.byteLength>0;){for(var h=new Uint8Array(e),i=0===h[0],j="",l=1;255!=h[l];l++){if(j.length>310){g=!0;break}j+=h[l]}if(g)return d(t,0,1);e=k(e,2+j.length),j=parseInt(j);var m=k(e,0,j);if(i)try{m=String.fromCharCode.apply(null,new Uint8Array(m))}catch(n){var o=new Uint8Array(m);m="";for(var l=0;l<o.length;l++)m+=String.fromCharCode(o[l])}f.push(m),e=k(e,j)}var p=f.length;f.forEach(function(a,e){d(c.decodePacket(a,b,!0),e,p)})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":36,utf8:31}],26:[function(a,b,c){b.exports=Object.keys||function(a){var b=[],c=Object.prototype.hasOwnProperty;for(var d in a)c.call(a,d)&&b.push(d);return b}},{}],27:[function(a,b,c){function d(a,b,c){function d(a,e){if(d.count<=0)throw new Error("after called too many times");--d.count,a?(f=!0,b(a),b=c):0!==d.count||f||b(null,e)}var f=!1;return c=c||e,d.count=a,0===a?b():d}function e(){}b.exports=d},{}],28:[function(a,b,c){b.exports=function(a,b,c){var d=a.byteLength;if(b=b||0,c=c||d,a.slice)return a.slice(b,c);if(0>b&&(b+=d),0>c&&(c+=d),c>d&&(c=d),b>=d||b>=c||0===d)return new ArrayBuffer(0);for(var e=new Uint8Array(a),f=new Uint8Array(c-b),g=b,h=0;c>g;g++,h++)f[h]=e[g];return f.buffer}},{}],29:[function(a,b,c){!function(a){"use strict";c.encode=function(b){var c,d=new Uint8Array(b),e=d.length,f="";for(c=0;e>c;c+=3)f+=a[d[c]>>2],f+=a[(3&d[c])<<4|d[c+1]>>4],f+=a[(15&d[c+1])<<2|d[c+2]>>6],f+=a[63&d[c+2]];return e%3===2?f=f.substring(0,f.length-1)+"=":e%3===1&&(f=f.substring(0,f.length-2)+"=="),f},c.decode=function(b){var c,d,e,f,g,h=.75*b.length,i=b.length,j=0;"="===b[b.length-1]&&(h--,"="===b[b.length-2]&&h--);var k=new ArrayBuffer(h),l=new Uint8Array(k);for(c=0;i>c;c+=4)d=a.indexOf(b[c]),e=a.indexOf(b[c+1]),f=a.indexOf(b[c+2]),g=a.indexOf(b[c+3]),l[j++]=d<<2|e>>4,l[j++]=(15&e)<<4|f>>2,l[j++]=(3&f)<<6|63&g;return k}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],30:[function(a,b,c){(function(a){function c(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.buffer instanceof ArrayBuffer){var d=c.buffer;if(c.byteLength!==d.byteLength){var e=new Uint8Array(c.byteLength);e.set(new Uint8Array(d,c.byteOffset,c.byteLength)),d=e.buffer}a[b]=d}}}function d(a,b){b=b||{};var d=new f;c(a);for(var e=0;e<a.length;e++)d.append(a[e]);return b.type?d.getBlob(b.type):d.getBlob()}function e(a,b){return c(a),new Blob(a,b||{})}var f=a.BlobBuilder||a.WebKitBlobBuilder||a.MSBlobBuilder||a.MozBlobBuilder,g=function(){try{var a=new Blob(["hi"]);return 2===a.size}catch(b){return!1}}(),h=g&&function(){try{var a=new Blob([new Uint8Array([1,2])]);return 2===a.size}catch(b){return!1}}(),i=f&&f.prototype.append&&f.prototype.getBlob;b.exports=function(){return g?h?a.Blob:e:i?d:void 0}()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[function(b,c,d){(function(b){!function(e){function f(a){for(var b,c,d=[],e=0,f=a.length;f>e;)b=a.charCodeAt(e++),b>=55296&&56319>=b&&f>e?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function g(a){for(var b,c=a.length,d=-1,e="";++d<c;)b=a[d],b>65535&&(b-=65536,e+=u(b>>>10&1023|55296),b=56320|1023&b),e+=u(b);return e}function h(a){if(a>=55296&&57343>=a)throw Error("Lone surrogate U+"+a.toString(16).toUpperCase()+" is not a scalar value")}function i(a,b){return u(a>>b&63|128)}function j(a){if(0==(4294967168&a))return u(a);var b="";return 0==(4294965248&a)?b=u(a>>6&31|192):0==(4294901760&a)?(h(a),b=u(a>>12&15|224),b+=i(a,6)):0==(4292870144&a)&&(b=u(a>>18&7|240),b+=i(a,12),b+=i(a,6)),b+=u(63&a|128)}function k(a){for(var b,c=f(a),d=c.length,e=-1,g="";++e<d;)b=c[e],g+=j(b);return g}function l(){if(t>=s)throw Error("Invalid byte index");var a=255&r[t];if(t++,128==(192&a))return 63&a;throw Error("Invalid continuation byte")}function m(){var a,b,c,d,e;if(t>s)throw Error("Invalid byte index");if(t==s)return!1;if(a=255&r[t],t++,0==(128&a))return a;if(192==(224&a)){var b=l();if(e=(31&a)<<6|b,e>=128)return e;throw Error("Invalid continuation byte")}if(224==(240&a)){if(b=l(),c=l(),e=(15&a)<<12|b<<6|c,e>=2048)return h(e),e;throw Error("Invalid continuation byte")}if(240==(248&a)&&(b=l(),c=l(),d=l(),e=(15&a)<<18|b<<12|c<<6|d,e>=65536&&1114111>=e))return e;throw Error("Invalid UTF-8 detected")}function n(a){r=f(a),s=r.length,t=0;for(var b,c=[];(b=m())!==!1;)c.push(b);return g(c)}var o="object"==typeof d&&d,p="object"==typeof c&&c&&c.exports==o&&c,q="object"==typeof b&&b;(q.global===q||q.window===q)&&(e=q);var r,s,t,u=String.fromCharCode,v={version:"2.0.0",encode:k,decode:n};if("function"==typeof a&&"object"==typeof a.amd&&a.amd)a(function(){return v});else if(o&&!o.nodeType)if(p)p.exports=v;else{var w={},x=w.hasOwnProperty;for(var y in v)x.call(v,y)&&(o[y]=v[y])}else e.utf8=v}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],32:[function(a,b,c){(function(a){var c=/^[\],:{}\s]*$/,d=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,e=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,f=/(?:^|:|,)(?:\s*\[)+/g,g=/^\s+/,h=/\s+$/;b.exports=function(b){return"string"==typeof b&&b?(b=b.replace(g,"").replace(h,""),a.JSON&&JSON.parse?JSON.parse(b):c.test(b.replace(d,"@").replace(e,"]").replace(f,""))?new Function("return "+b)():void 0):null}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],33:[function(a,b,c){c.encode=function(a){var b="";for(var c in a)a.hasOwnProperty(c)&&(b.length&&(b+="&"),b+=encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b},c.decode=function(a){for(var b={},c=a.split("&"),d=0,e=c.length;e>d;d++){var f=c[d].split("=");b[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}return b}},{}],34:[function(a,b,c){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];b.exports=function(a){var b=a,c=a.indexOf("["),f=a.indexOf("]");-1!=c&&-1!=f&&(a=a.substring(0,c)+a.substring(c,f).replace(/:/g,";")+a.substring(f,a.length));for(var g=d.exec(a||""),h={},i=14;i--;)h[e[i]]=g[i]||"";return-1!=c&&-1!=f&&(h.source=b,h.host=h.host.substring(1,h.host.length-1).replace(/;/g,":"),h.authority=h.authority.replace("[","").replace("]","").replace(/;/g,":"),h.ipv6uri=!0),h}},{}],35:[function(a,b,c){function d(a,b,c){var d;return d=b?new f(a,b):new f(a)}var e=function(){return this}(),f=e.WebSocket||e.MozWebSocket;b.exports=f?d:null,f&&(d.prototype=f.prototype)},{}],36:[function(a,b,c){(function(c){function d(a){function b(a){if(!a)return!1;if(c.Buffer&&c.Buffer.isBuffer(a)||c.ArrayBuffer&&a instanceof ArrayBuffer||c.Blob&&a instanceof Blob||c.File&&a instanceof File)return!0;if(e(a)){for(var d=0;d<a.length;d++)if(b(a[d]))return!0}else if(a&&"object"==typeof a){a.toJSON&&(a=a.toJSON());for(var f in a)if(Object.prototype.hasOwnProperty.call(a,f)&&b(a[f]))return!0}return!1}return b(a)}var e=a("isarray");b.exports=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:37}],37:[function(a,b,c){b.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},{}],38:[function(a,b,c){var d=a("global");try{b.exports="XMLHttpRequest"in d&&"withCredentials"in new d.XMLHttpRequest}catch(e){b.exports=!1}},{global:39}],39:[function(a,b,c){b.exports=function(){return this}()},{}],40:[function(a,b,c){var d=[].indexOf;b.exports=function(a,b){if(d)return a.indexOf(b);for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}},{}],41:[function(a,b,c){var d=Object.prototype.hasOwnProperty;c.keys=Object.keys||function(a){var b=[];for(var c in a)d.call(a,c)&&b.push(c);return b},c.values=function(a){var b=[];for(var c in a)d.call(a,c)&&b.push(a[c]);return b},c.merge=function(a,b){for(var c in b)d.call(b,c)&&(a[c]=b[c]);return a},c.length=function(a){return c.keys(a).length},c.isEmpty=function(a){return 0==c.length(a)}},{}],42:[function(a,b,c){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];b.exports=function(a){for(var b=d.exec(a||""),c={},f=14;f--;)c[e[f]]=b[f]||"";return c}},{}],43:[function(a,b,c){(function(b){var d=a("isarray"),e=a("./is-buffer");c.deconstructPacket=function(a){function b(a){if(!a)return a;if(e(a)){var f={_placeholder:!0,num:c.length};return c.push(a),f}if(d(a)){for(var g=new Array(a.length),h=0;h<a.length;h++)g[h]=b(a[h]);return g}if("object"==typeof a&&!(a instanceof Date)){var g={};for(var i in a)g[i]=b(a[i]);return g}return a}var c=[],f=a.data,g=a;return g.data=b(f),g.attachments=c.length,{packet:g,buffers:c}},c.reconstructPacket=function(a,b){function c(a){if(a&&a._placeholder){var e=b[a.num];return e}if(d(a)){for(var f=0;f<a.length;f++)a[f]=c(a[f]);return a}if(a&&"object"==typeof a){for(var g in a)a[g]=c(a[g]);return a}return a}return a.data=c(a.data),a.attachments=void 0,a},c.removeBlobs=function(a,c){function f(a,i,j){if(!a)return a;if(b.Blob&&a instanceof Blob||b.File&&a instanceof File){g++;var k=new FileReader;k.onload=function(){j?j[i]=this.result:h=this.result,--g||c(h)},k.readAsArrayBuffer(a)}else if(d(a))for(var l=0;l<a.length;l++)f(a[l],l,a);else if(a&&"object"==typeof a&&!e(a))for(var m in a)f(a[m],m,a)}var g=0,h=a;f(h),g||c(h)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":45,isarray:46}],44:[function(a,b,c){function d(){}function e(a){var b="",d=!1;return b+=a.type,(c.BINARY_EVENT==a.type||c.BINARY_ACK==a.type)&&(b+=a.attachments,b+="-"),a.nsp&&"/"!=a.nsp&&(d=!0,b+=a.nsp),null!=a.id&&(d&&(b+=",",d=!1),b+=a.id),null!=a.data&&(d&&(b+=","),b+=l.stringify(a.data)),k("encoded %j as %s",a,b),b}function f(a,b){function c(a){var c=n.deconstructPacket(a),d=e(c.packet),f=c.buffers;f.unshift(d),b(f)}n.removeBlobs(a,c)}function g(){this.reconstructor=null}function h(a){var b={},d=0;if(b.type=Number(a.charAt(0)),null==c.types[b.type])return j();if(c.BINARY_EVENT==b.type||c.BINARY_ACK==b.type){for(var e="";"-"!=a.charAt(++d)&&(e+=a.charAt(d),d!=a.length););if(e!=Number(e)||"-"!=a.charAt(d))throw new Error("Illegal attachments");b.attachments=Number(e)}if("/"==a.charAt(d+1))for(b.nsp="";++d;){var f=a.charAt(d);if(","==f)break;if(b.nsp+=f,d==a.length)break}else b.nsp="/";var g=a.charAt(d+1);if(""!==g&&Number(g)==g){for(b.id="";++d;){var f=a.charAt(d);if(null==f||Number(f)!=f){--d;break}if(b.id+=a.charAt(d),d==a.length)break}b.id=Number(b.id)}if(a.charAt(++d))try{b.data=l.parse(a.substr(d))}catch(h){return j()}return k("decoded %s as %j",a,b),b}function i(a){this.reconPack=a,this.buffers=[]}function j(a){return{type:c.ERROR,data:"parser error"}}var k=a("debug")("socket.io-parser"),l=a("json3"),m=(a("isarray"),a("component-emitter")),n=a("./binary"),o=a("./is-buffer");c.protocol=4,c.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],c.CONNECT=0,c.DISCONNECT=1,c.EVENT=2,c.ACK=3,c.ERROR=4,c.BINARY_EVENT=5,c.BINARY_ACK=6,c.Encoder=d,c.Decoder=g,d.prototype.encode=function(a,b){if(k("encoding packet %j",a),c.BINARY_EVENT==a.type||c.BINARY_ACK==a.type)f(a,b);else{var d=e(a);b([d])}},m(g.prototype),g.prototype.add=function(a){var b;if("string"==typeof a)b=h(a),c.BINARY_EVENT==b.type||c.BINARY_ACK==b.type?(this.reconstructor=new i(b),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",b)):this.emit("decoded",b);else{if(!o(a)&&!a.base64)throw new Error("Unknown type: "+a);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");b=this.reconstructor.takeBinaryData(a),b&&(this.reconstructor=null,this.emit("decoded",b))}},g.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},i.prototype.takeBinaryData=function(a){if(this.buffers.push(a),this.buffers.length==this.reconPack.attachments){var b=n.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),b}return null},i.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":43,"./is-buffer":45,"component-emitter":9,debug:10,isarray:46,json3:47}],45:[function(a,b,c){(function(a){function c(b){return a.Buffer&&a.Buffer.isBuffer(b)||a.ArrayBuffer&&b instanceof ArrayBuffer}b.exports=c}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(a,b,c){b.exports=a(37)},{}],47:[function(b,c,d){!function(b){function c(a){if(c[a]!==g)return c[a];var b;if("bug-string-char-index"==a)b="a"!="a"[0];else if("json"==a)b=c("json-stringify")&&c("json-parse");else{var d,e='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==a){var f=k.stringify,i="function"==typeof f&&l;if(i){(d=function(){return 1}).toJSON=d;try{i="0"===f(0)&&"0"===f(new Number)&&'""'==f(new String)&&f(h)===g&&f(g)===g&&f()===g&&"1"===f(d)&&"[1]"==f([d])&&"[null]"==f([g])&&"null"==f(null)&&"[null,null,null]"==f([g,h,null])&&f({a:[d,!0,!1,null,"\x00\b\n\f\r	"]})==e&&"1"===f(null,d)&&"[\n 1,\n 2\n]"==f([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==f(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==f(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==f(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==f(new Date(-1))}catch(j){i=!1}}b=i}if("json-parse"==a){var m=k.parse;if("function"==typeof m)try{if(0===m("0")&&!m(!1)){d=m(e);var n=5==d.a.length&&1===d.a[0];if(n){try{n=!m('"	"')}catch(j){}if(n)try{n=1!==m("01")}catch(j){}if(n)try{n=1!==m("1.")}catch(j){}}}}catch(j){n=!1}b=n}}return c[a]=!!b}var e,f,g,h={}.toString,i="function"==typeof a&&a.amd,j="object"==typeof JSON&&JSON,k="object"==typeof d&&d&&!d.nodeType&&d;k&&j?(k.stringify=j.stringify,k.parse=j.parse):k=b.JSON=j||{};var l=new Date(-0xc782b5b800cec);try{l=-109252==l.getUTCFullYear()&&0===l.getUTCMonth()&&1===l.getUTCDate()&&10==l.getUTCHours()&&37==l.getUTCMinutes()&&6==l.getUTCSeconds()&&708==l.getUTCMilliseconds()}catch(m){}if(!c("json")){var n="[object Function]",o="[object Date]",p="[object Number]",q="[object String]",r="[object Array]",s="[object Boolean]",t=c("bug-string-char-index");if(!l)var u=Math.floor,v=[0,31,59,90,120,151,181,212,243,273,304,334],w=function(a,b){return v[b]+365*(a-1970)+u((a-1969+(b=+(b>1)))/4)-u((a-1901+b)/100)+u((a-1601+b)/400)};(e={}.hasOwnProperty)||(e=function(a){var b,c={};return(c.__proto__=null,c.__proto__={toString:1},c).toString!=h?e=function(a){var b=this.__proto__,c=a in(this.__proto__=null,this);return this.__proto__=b,c}:(b=c.constructor,e=function(a){var c=(this.constructor||b).prototype;return a in this&&!(a in c&&this[a]===c[a])}),c=null,e.call(this,a)});var x={"boolean":1,number:1,string:1,undefined:1},y=function(a,b){var c=typeof a[b];return"object"==c?!!a[b]:!x[c]};if(f=function(a,b){var c,d,g,i=0;(c=function(){this.valueOf=0}).prototype.valueOf=0,d=new c;for(g in d)e.call(d,g)&&i++;return c=d=null,i?f=2==i?function(a,b){var c,d={},f=h.call(a)==n;for(c in a)f&&"prototype"==c||e.call(d,c)||!(d[c]=1)||!e.call(a,c)||b(c)}:function(a,b){var c,d,f=h.call(a)==n;for(c in a)f&&"prototype"==c||!e.call(a,c)||(d="constructor"===c)||b(c);(d||e.call(a,c="constructor"))&&b(c)}:(d=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],f=function(a,b){var c,f,g=h.call(a)==n,i=!g&&"function"!=typeof a.constructor&&y(a,"hasOwnProperty")?a.hasOwnProperty:e;for(c in a)g&&"prototype"==c||!i.call(a,c)||b(c);for(f=d.length;c=d[--f];i.call(a,c)&&b(c));}),f(a,b)},!c("json-stringify")){var z={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},A="000000",B=function(a,b){return(A+(b||0)).slice(-a)},C="\\u00",D=function(a){var b,c='"',d=0,e=a.length,f=e>10&&t;for(f&&(b=a.split(""));e>d;d++){var g=a.charCodeAt(d);switch(g){case 8:case 9:case 10:case 12:case 13:case 34:case 92:c+=z[g];break;default:if(32>g){c+=C+B(2,g.toString(16));break}c+=f?b[d]:t?a.charAt(d):a[d]}}return c+'"'},E=function(a,b,c,d,i,j,k){var l,m,n,t,v,x,y,z,A,C,F,G,H,I,J,K;try{l=b[a]}catch(L){}if("object"==typeof l&&l)if(m=h.call(l),m!=o||e.call(l,"toJSON"))"function"==typeof l.toJSON&&(m!=p&&m!=q&&m!=r||e.call(l,"toJSON"))&&(l=l.toJSON(a));else if(l>-1/0&&1/0>l){if(w){for(v=u(l/864e5),n=u(v/365.2425)+1970-1;w(n+1,0)<=v;n++);for(t=u((v-w(n,0))/30.42);w(n,t+1)<=v;t++);v=1+v-w(n,t),x=(l%864e5+864e5)%864e5,y=u(x/36e5)%24,z=u(x/6e4)%60,A=u(x/1e3)%60,C=x%1e3}else n=l.getUTCFullYear(),t=l.getUTCMonth(),v=l.getUTCDate(),y=l.getUTCHours(),z=l.getUTCMinutes(),A=l.getUTCSeconds(),C=l.getUTCMilliseconds();l=(0>=n||n>=1e4?(0>n?"-":"+")+B(6,0>n?-n:n):B(4,n))+"-"+B(2,t+1)+"-"+B(2,v)+"T"+B(2,y)+":"+B(2,z)+":"+B(2,A)+"."+B(3,C)+"Z"}else l=null;if(c&&(l=c.call(b,a,l)),null===l)return"null";if(m=h.call(l),m==s)return""+l;if(m==p)return l>-1/0&&1/0>l?""+l:"null";if(m==q)return D(""+l);if("object"==typeof l){for(I=k.length;I--;)if(k[I]===l)throw TypeError();if(k.push(l),F=[],J=j,j+=i,m==r){for(H=0,I=l.length;I>H;H++)G=E(H,l,c,d,i,j,k),F.push(G===g?"null":G);K=F.length?i?"[\n"+j+F.join(",\n"+j)+"\n"+J+"]":"["+F.join(",")+"]":"[]"}else f(d||l,function(a){var b=E(a,l,c,d,i,j,k);b!==g&&F.push(D(a)+":"+(i?" ":"")+b)}),K=F.length?i?"{\n"+j+F.join(",\n"+j)+"\n"+J+"}":"{"+F.join(",")+"}":"{}";return k.pop(),K}};k.stringify=function(a,b,c){var d,e,f,g;if("function"==typeof b||"object"==typeof b&&b)if((g=h.call(b))==n)e=b;else if(g==r){f={};for(var i,j=0,k=b.length;k>j;i=b[j++],g=h.call(i),(g==q||g==p)&&(f[i]=1));}if(c)if((g=h.call(c))==p){if((c-=c%1)>0)for(d="",c>10&&(c=10);d.length<c;d+=" ");}else g==q&&(d=c.length<=10?c:c.slice(0,10));return E("",(i={},i[""]=a,i),e,f,d,"",[])}}if(!c("json-parse")){var F,G,H=String.fromCharCode,I={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},J=function(){throw F=G=null,SyntaxError()},K=function(){for(var a,b,c,d,e,f=G,g=f.length;g>F;)switch(e=f.charCodeAt(F)){case 9:case 10:case 13:case 32:F++;break;case 123:case 125:case 91:case 93:case 58:case 44:return a=t?f.charAt(F):f[F],F++,a;case 34:for(a="@",F++;g>F;)if(e=f.charCodeAt(F),32>e)J();else if(92==e)switch(e=f.charCodeAt(++F)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:a+=I[e],F++;break;case 117:for(b=++F,c=F+4;c>F;F++)e=f.charCodeAt(F),e>=48&&57>=e||e>=97&&102>=e||e>=65&&70>=e||J();a+=H("0x"+f.slice(b,F));break;default:J()}else{if(34==e)break;for(e=f.charCodeAt(F),b=F;e>=32&&92!=e&&34!=e;)e=f.charCodeAt(++F);a+=f.slice(b,F)}if(34==f.charCodeAt(F))return F++,a;J();default:if(b=F,45==e&&(d=!0,e=f.charCodeAt(++F)),e>=48&&57>=e){for(48==e&&(e=f.charCodeAt(F+1),e>=48&&57>=e)&&J(),d=!1;g>F&&(e=f.charCodeAt(F),e>=48&&57>=e);F++);if(46==f.charCodeAt(F)){for(c=++F;g>c&&(e=f.charCodeAt(c),e>=48&&57>=e);c++);c==F&&J(),F=c}if(e=f.charCodeAt(F),101==e||69==e){for(e=f.charCodeAt(++F),(43==e||45==e)&&F++,c=F;g>c&&(e=f.charCodeAt(c),e>=48&&57>=e);c++);c==F&&J(),F=c}return+f.slice(b,F)}if(d&&J(),"true"==f.slice(F,F+4))return F+=4,!0;if("false"==f.slice(F,F+5))return F+=5,!1;if("null"==f.slice(F,F+4))return F+=4,null;J()}return"$"},L=function(a){var b,c;if("$"==a&&J(),"string"==typeof a){if("@"==(t?a.charAt(0):a[0]))return a.slice(1);if("["==a){for(b=[];a=K(),"]"!=a;c||(c=!0))c&&(","==a?(a=K(),"]"==a&&J()):J()),","==a&&J(),b.push(L(a));return b}if("{"==a){for(b={};a=K(),"}"!=a;c||(c=!0))c&&(","==a?(a=K(),"}"==a&&J()):J()),(","==a||"string"!=typeof a||"@"!=(t?a.charAt(0):a[0])||":"!=K())&&J(),b[a.slice(1)]=L(K());return b}J()}return a},M=function(a,b,c){var d=N(a,b,c);d===g?delete a[b]:a[b]=d},N=function(a,b,c){var d,e=a[b];if("object"==typeof e&&e)if(h.call(e)==r)for(d=e.length;d--;)M(e,d,c);else f(e,function(a){M(e,a,c)});return c.call(a,b,e)};k.parse=function(a,b){var c,d;return F=0,G=""+a,c=L(K()),"$"!=K()&&J(),F=G=null,b&&h.call(b)==n?N((d={},d[""]=c,d),"",b):c}}}i&&a(function(){return k})}(this)},{}],48:[function(a,b,c){function d(a,b){var c=[];b=b||0;for(var d=b||0;d<a.length;d++)c[d-b]=a[d];return c}b.exports=d},{}]},{},[1])(1)}),function(a){var b,c=a.Tuio,d=Array.prototype.slice;Array.prototype.splice;b="undefined"!=typeof exports?exports:a.Tuio={},b.VERSION="0.0.1";var e=a._;e||"undefined"==typeof require||(e=require("lodash")),b.noConflict=function(){return a.Tuio=c,this};var f=/\s+/,g=b.Events={on:function(a,b,c){var d,e,g,h,i;if(!b)return this;for(a=a.split(f),d=this._callbacks||(this._callbacks={});e=a.shift();)i=d[e],g=i?i.tail:{},g.next=h={},g.context=c,g.callback=b,d[e]={tail:h,next:i?i.next:g};return this},off:function(a,b,c){var d,g,h,i,j,k;if(g=this._callbacks){if(!(a||b||c))return delete this._callbacks,this;for(a=a?a.split(f):e.keys(g);d=a.shift();)if(h=g[d],delete g[d],h&&(b||c))for(i=h.tail;(h=h.next)!==i;)j=h.callback,k=h.context,(b&&j!==b||c&&k!==c)&&this.on(d,j,k);return this}},trigger:function(a){var b,c,e,g,h,i,j;if(!(e=this._callbacks))return this;for(i=e.all,a=a.split(f),j=d.call(arguments,1);b=a.shift();){if(c=e[b])for(g=c.tail;(c=c.next)!==g;)c.callback.apply(c.context||this,j);if(c=i)for(g=c.tail,h=[b].concat(j);(c=c.next)!==g;)c.callback.apply(c.context||this,h)}return this}},h=b.Model=function(){this.initialize.apply(this,arguments)};e.extend(h.prototype,g);var i=function(a,b){var c=k(this,a,b);return c.extend=this.extend,c};b.Model.extend=i;var j=function(){},k=function(a,b,c){var d;return d=b&&b.hasOwnProperty("constructor")?b.constructor:function(){a.apply(this,arguments)},e.extend(d,a),j.prototype=a.prototype,d.prototype=new j,b&&e.extend(d.prototype,b),c&&e.extend(d,c),d.prototype.constructor=d,d.__super__=a.prototype,d}}(this),Tuio.Time=Tuio.Model.extend({seconds:0,microSeconds:0,initialize:function(a,b){this.seconds=a||0,this.microSeconds=b||0},add:function(a){return new Tuio.Time(this.seconds+Math.floor(a/1e6),this.microSeconds+a%1e6)},addTime:function(a){var b=this.seconds+a.getSeconds(),c=this.microSeconds+a.getMicroseconds();return b+=Math.floor(c/1e6),c%=1e6,new Tuio.Time(b,c)},subtract:function(a){var b=this.seconds-Math.floor(a/1e6),c=this.microSeconds-a%1e6;return 0>c&&(c+=1e6,b-=1),new Tuio.Time(b,c)},subtractTime:function(a){var b=this.seconds-a.getSeconds(),c=this.microSeconds-a.getMicroseconds();return 0>c&&(c+=1e6,b-=1),new Tuio.Time(b,c)},equals:function(a){return this.seconds===a.getSeconds()&&this.microSeconds===a.getMicroseconds()},reset:function(){this.seconds=0,this.microSeconds=0},getSeconds:function(){return this.seconds},getMicroseconds:function(){return this.microSeconds},getTotalMilliseconds:function(){return 1e3*this.seconds+Math.floor(this.microSeconds/1e3)}},{startSeconds:0,startMicroSeconds:0,fromMilliseconds:function(a){return new Tuio.Time(Math.floor(a/1e3),1e3*(a%1e3))},fromTime:function(a){return new Tuio.Time(a.getSeconds(),a.getMicroseconds())},initSession:function(){var a=Tuio.Time.getSystemTime();Tuio.Time.startSeconds=a.getSeconds(),Tuio.Time.startMicroSeconds=a.getMicroseconds()},getSessionTime:function(){return Tuio.Time.getSystemTime().subtractTime(Tuio.Time.getStartTime())},getStartTime:function(){return new Tuio.Time(Tuio.Time.startSeconds,Tuio.Time.startMicroSeconds)},getSystemTime:function(){var a=1e3*(new Date).getTime();return new Tuio.Time(Math.floor(a/1e6),a%1e6)}}),Tuio.Point=Tuio.Model.extend({xPos:null,yPos:null,currentTime:null,startTime:null,initialize:function(a){this.xPos=a.xp||0,this.yPos=a.yp||0,this.currentTime=Tuio.Time.fromTime(a.ttime||Tuio.Time.getSessionTime()),this.startTime=Tuio.Time.fromTime(this.currentTime)},update:function(a){this.xPos=a.xp,this.yPos=a.yp,a.hasOwnProperty("ttime")&&(this.currentTime=Tuio.Time.fromTime(a.ttime))},updateToPoint:function(a){this.xPos=a.getX(),this.yPos=a.getY()},getX:function(){return this.xPos},getY:function(){return this.yPos},getDistance:function(a,b){var c=this.xPos-a,d=this.yPos-b;return Math.sqrt(c*c+d*d)},getDistanceToPoint:function(a){return this.getDistance(a.getX(),a.getY())},getAngle:function(a,b){var c=this.xPos-a,d=this.yPos-b,e=this.getDistance(a,b),f=Math.asin(c/e)+Math.PI/2;return 0>d&&(f=2*Math.PI-f),f},getAngleToPoint:function(a){return this.getAngle(a.getX(),a.getY())},getAngleDegrees:function(a,b){return this.getAngle(a,b)/Math.PI*180},getAngleDegreesToPoint:function(a){return this.getAngleToPoint(a)/Math.PI*180},getScreenX:function(a){return Math.round(this.xPos*a)},getScreenY:function(a){return Math.round(this.yPos*a)},getTuioTime:function(){return Tuio.Time.fromTime(this.currentTime)},getStartTime:function(){return Tuio.Time.fromTime(this.startTime)}},{fromPoint:function(a){return new Tuio.Point({xp:a.getX(),yp:a.getY()})}}),Tuio.Container=Tuio.Point.extend({sessionId:null,xSpeed:null,ySpeed:null,motionSpeed:null,motionAccel:null,path:null,state:null,initialize:function(a){Tuio.Point.prototype.initialize.call(this,a),this.sessionId=a.si,this.xSpeed=0,this.ySpeed=0,this.motionSpeed=0,this.motionAccel=0,this.path=[new Tuio.Point({ttime:this.currentTime,xp:this.xPos,yp:this.yPos})],this.state=Tuio.Container.TUIO_ADDED},update:function(a){var b=this.path[this.path.length-1];if(Tuio.Point.prototype.update.call(this,a),a.hasOwnProperty("xs")&&a.hasOwnProperty("ys")&&a.hasOwnProperty("ma"))this.xSpeed=a.xs,this.ySpeed=a.ys,this.motionSpeed=Math.sqrt(this.xSpeed*this.xSpeed+this.ySpeed*this.ySpeed),this.motionAccel=a.ma;else{var c=this.currentTime.subtractTime(b.getTuioTime()),d=c.getTotalMilliseconds()/1e3,e=this.xPos-b.getX(),f=this.yPos-b.getY(),g=Math.sqrt(e*e+f*f),h=this.motionSpeed;this.xSpeed=e/d,this.ySpeed=f/d,this.motionSpeed=g/d,this.motionAccel=(this.motionSpeed-h)/d}this.updatePathAndState()},updateContainer:function(a){Tuio.Point.prototype.updateToPoint.call(this,a),this.xSpeed=a.getXSpeed(),this.ySpeed=a.getYSpeed(),this.motionSpeed=a.getMotionSpeed(),this.motionAccel=a.getMotionAccel(),this.updatePathAndState()},updatePathAndState:function(){this.path.push(new Tuio.Point({ttime:this.currentTime,xp:this.xPos,yp:this.yPos})),this.motionAccel>0?this.state=Tuio.Container.TUIO_ACCELERATING:this.motionAccel<0?this.state=Tuio.Container.TUIO_DECELERATING:this.state=Tuio.Container.TUIO_STOPPED},stop:function(a){this.update({ttime:a,xp:this.xPos,yp:this.yPos})},remove:function(a){this.currentTime=Tuio.Time.fromTime(a),this.state=Tuio.Container.TUIO_REMOVED},getSessionId:function(){return this.sessionId},getXSpeed:function(){return this.xSpeed},getYSpeed:function(){return this.ySpeed},getPosition:function(){return new Tuio.Point(this.xPos,this.yPos)},getPath:function(){return this.path},getMotionSpeed:function(){return this.motionSpeed},getMotionAccel:function(){return this.motionAccel},getTuioState:function(){return this.state},isMoving:function(){return this.state===Tuio.Container.TUIO_ACCELERATING||this.state===Tuio.Container.TUIO_DECELERATING}},{TUIO_ADDED:0,TUIO_ACCELERATING:1,TUIO_DECELERATING:2,TUIO_STOPPED:3,TUIO_REMOVED:4,fromContainer:function(a){return new Tuio.Container({xp:a.getX(),yp:a.getY(),
si:a.getSessionID()})}}),Tuio.Cursor=Tuio.Container.extend({cursorId:null,initialize:function(a){Tuio.Container.prototype.initialize.call(this,a),this.cursorId=a.ci},getCursorId:function(){return this.cursorId}},{fromCursor:function(a){return new Tuio.Cursor({si:a.getSessionId(),ci:a.getCursorId(),xp:a.getX(),yp:a.getY()})}}),Tuio.Object=Tuio.Container.extend({symbolId:null,angle:null,rotationSpeed:null,rotationAccel:null,initialize:function(a){Tuio.Container.prototype.initialize.call(this,a),this.symbolId=a.sym,this.angle=a.a,this.rotationSpeed=0,this.rotationAccel=0},update:function(a){var b=this.path[this.path.length-1];if(Tuio.Container.prototype.update.call(this,a),a.hasOwnProperty("rs")&&a.hasOwnProperty("ra"))this.angle=a.a,this.rotationSpeed=a.rs,this.rotationAccel=a.ra;else{var c=this.currentTime.subtractTime(b.getTuioTime()),d=c.getTotalMilliseconds()/1e3,e=this.angle,f=this.rotationSpeed;this.angle=a.a;var g=(this.angle-e)/(2*Math.PI);g>.75?g-=1:-.75>g&&(g+=1),this.rotationSpeed=g/d,this.rotationAccel=(this.rotationSpeed-f)/d}this.updateObjectState()},updateObject:function(a){Tuio.Container.prototype.updateContainer.call(this,a),this.angle=a.getAngle(),this.rotationSpeed=a.getRotationSpeed(),this.rotationAccel=a.getRotationAccel(),this.updateObjectState()},updateObjectState:function(){0!==this.rotationAccel&&(this.state=Tuio.Object.TUIO_ROTATING)},stop:function(a){this.update({ttime:a,xp:this.xPos,yp:this.yPos,a:this.angle})},getSymbolId:function(){return this.symbolId},getAngle:function(){return this.angle},getAngleDegrees:function(){return this.angle/Math.PI*180},getRotationSpeed:function(){return this.rotationSpeed},getRotationAccel:function(){return this.rotationAccel},isMoving:function(){return this.state===Tuio.Object.TUIO_ACCELERATING||this.state===Tuio.Object.TUIO_DECELERATING||this.state===Tuio.Object.TUIO_ROTATING}},{TUIO_ROTATING:5,fromObject:function(a){return new Tuio.Object({xp:a.getX(),yp:a.getY(),si:a.getSessionID(),sym:a.getSymbolId(),a:a.getAngle()})}}),Tuio.Client=Tuio.Model.extend({host:null,socket:null,connected:null,objectList:null,aliveObjectList:null,newObjectList:null,cursorList:null,aliveCursorList:null,newCursorList:null,frameObjects:null,frameCursors:null,freeCursorList:null,maxCursorId:null,currentFrame:null,currentTime:null,initialize:function(a){this.host=a.host,this.connected=!1,this.objectList={},this.aliveObjectList=[],this.newObjectList=[],this.cursorList={},this.aliveCursorList=[],this.newCursorList=[],this.frameObjects=[],this.frameCursors=[],this.freeCursorList=[],this.maxCursorId=-1,this.currentFrame=0,this.currentTime=null,_.bindAll(this,"onConnect","acceptBundle","onDisconnect")},connect:function(){Tuio.Time.initSession(),this.currentTime=new Tuio.Time,this.currentTime.reset(),this.socket=io.connect(this.host),this.socket.on("connect",this.onConnect),this.socket.on("disconnect",this.onDisconnect)},disconnect:function(){this.socket.disconnect()},onConnect:function(){this.socket.on("osc",this.acceptBundle),console.log("connection established"),this.connected=!0,this.trigger("connect")},onDisconnect:function(){this.connected=!1,console.log("connection lost"),this.trigger("disconnect")},isConnected:function(){return this.connected},getTuioObjects:function(){return _.clone(this.objectList)},getTuioCursors:function(){return _.clone(this.cursorList)},getTuioObject:function(a){return this.objectList[a]},getTuioCursor:function(a){return this.cursorList[a]},acceptBundle:function(a){for(var b=osc.readPacket(a.data,{},a.offset,a.length),c=b.packets,d=0,e=c.length;e>d;d++){var f=c[d];switch(f.address){case"/tuio/2Dobj":case"/tuio/2Dcur":this.acceptMessage(f);break;case"/tuio/2Dblb":console.log("Blog received")}}},acceptMessage:function(a){var b=a.address,c=a.args[0],d=a.args.slice(1,a.length);switch(b){case"/tuio/2Dobj":this.handleObjectMessage(c,d);break;case"/tuio/2Dcur":this.handleCursorMessage(c,d)}},handleObjectMessage:function(a,b){switch(a){case"set":this.objectSet(b);break;case"alive":this.objectAlive(b);break;case"fseq":this.objectFseq(b)}},handleCursorMessage:function(a,b){switch(a){case"set":this.cursorSet(b);break;case"alive":this.cursorAlive(b);break;case"fseq":this.cursorFseq(b)}},objectSet:function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9];if(_.has(this.objectList,b)){var l=this.objectList[b];if(!l)return;if(l.xPos!==d||l.yPos!==e||l.angle!==f||l.xSpeed!==g||l.ySpeed!==h||l.rotationSpeed!==i||l.motionAccel!==j||l.rotationAccel!==k){var m=new Tuio.Object({si:b,sym:c,xp:d,yp:e,a:f});m.update({xp:d,yp:e,a:f,xs:g,ys:h,rs:i,ma:j,ra:k}),this.frameObjects.push(m)}}else{var n=new Tuio.Object({si:b,sym:c,xp:d,yp:e,a:f});this.frameObjects.push(n)}},objectAlive:function(a){var b=null;this.newObjectList=a,this.aliveObjectList=_.difference(this.aliveObjectList,this.newObjectList);for(var c=0,d=this.aliveObjectList.length;d>c;c++)b=this.objectList[this.aliveObjectList[c]],b&&(b.remove(this.currentTime),this.frameObjects.push(b))},objectFseq:function(a){var b=a[0],c=!1,d=null;if(b>0?(b>this.currentFrame&&(this.currentTime=Tuio.Time.getSessionTime()),b>=this.currentFrame||this.currentFrame-b>100?this.currentFrame=b:c=!0):Tuio.Time.getSessionTime().subtractTime(this.currentTime).getTotalMilliseconds()>100&&(this.currentTime=Tuio.Time.getSessionTime()),!c){for(var e=0,f=this.frameObjects.length;f>e;e++)switch(d=this.frameObjects[e],d.getTuioState()){case Tuio.Object.TUIO_REMOVED:this.objectRemoved(d);break;case Tuio.Object.TUIO_ADDED:this.objectAdded(d);break;default:this.objectDefault(d)}this.trigger("refresh",Tuio.Time.fromTime(this.currentTime));var g=this.aliveObjectList;this.aliveObjectList=this.newObjectList,this.newObjectList=g}this.frameObjects=[]},objectRemoved:function(a){var b=a;b.remove(this.currentTime),this.trigger("removeTuioObject",b),delete this.objectList[b.getSessionId()]},objectAdded:function(a){var b=new Tuio.Object({ttime:this.currentTime,si:a.getSessionId(),sym:a.getSymbolId(),xp:a.getX(),yp:a.getY(),a:a.getAngle()});this.objectList[b.getSessionId()]=b,this.trigger("addTuioObject",b)},objectDefault:function(a){var b=this.objectList[a.getSessionId()];a.getX()!==b.getX()&&0===a.getXSpeed()||a.getY()!==b.getY()&&0===a.getYSpeed()?b.update({ttime:this.currentTime,xp:a.getX(),yp:a.getY(),a:a.getAngle()}):b.update({ttime:this.currentTime,xp:a.getX(),yp:a.getY(),a:a.getAngle(),xs:a.getXSpeed(),ys:a.getYSpeed(),rs:a.getRotationSpeed(),ma:a.getMotionAccel(),ra:a.getRotationAccel()}),this.trigger("updateTuioObject",b)},cursorSet:function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5];if(_.has(this.cursorList,b)){var h=this.cursorList[b];if(!h)return;if(h.xPos!==c||h.yPos!==d||h.xSpeed!==e||h.ySpeed!==f||h.motionAccel!==g){var i=new Tuio.Cursor({si:b,ci:h.getCursorId(),xp:c,yp:d});i.update({xp:c,yp:d,xs:e,ys:f,ma:g}),this.frameCursors.push(i)}}else{var j=new Tuio.Cursor({si:b,ci:-1,xp:c,yp:d});this.frameCursors.push(j)}},cursorAlive:function(a){var b=null;this.newCursorList=a,this.aliveCursorList=_.difference(this.aliveCursorList,this.newCursorList);for(var c=0,d=this.aliveCursorList.length;d>c;c++)b=this.cursorList[this.aliveCursorList[c]],b&&(b.remove(this.currentTime),this.frameCursors.push(b))},cursorFseq:function(a){var b=a[0],c=!1,d=null;if(b>0?(b>this.currentFrame&&(this.currentTime=Tuio.Time.getSessionTime()),b>=this.currentFrame||this.currentFrame-b>100?this.currentFrame=b:c=!0):Tuio.Time.getSessionTime().subtractTime(this.currentTime).getTotalMilliseconds()>100&&(this.currentTime=Tuio.Time.getSessionTime()),!c){for(var e=0,f=this.frameCursors.length;f>e;e++)switch(d=this.frameCursors[e],d.getTuioState()){case Tuio.Cursor.TUIO_REMOVED:this.cursorRemoved(d);break;case Tuio.Cursor.TUIO_ADDED:this.cursorAdded(d);break;default:this.cursorDefault(d)}this.trigger("refresh",Tuio.Time.fromTime(this.currentTime));var g=this.aliveCursorList;this.aliveCursorList=this.newCursorList,this.newCursorList=g}this.frameCursors=[]},cursorRemoved:function(a){var b=a;if(b.remove(this.currentTime),this.trigger("removeTuioCursor",b),delete this.cursorList[b.getSessionId()],b.getCursorId()===this.maxCursorId)if(this.maxCursorId=-1,_.size(this.cursorList)>0){var c=_.max(this.cursorList,function(a){return a.getCursorId()});c.getCursorId()>this.maxCursorId&&(this.maxCursorId=c.getCursorId()),this.freeCursorList=_.without(this.freeCursorList,function(a){return a.getCursorId()>=this.maxCursorId})}else this.freeCursorList=[];else b.getCursorId()<this.maxCursorId&&this.freeCursorList.push(b)},cursorAdded:function(a){var b=_.size(this.cursorList),c=null;if(b<=this.maxCursorId&&this.freeCursorList.length>0){for(var d=this.freeCursorList[0],e=0,f=this.freeCursorList.length;f>e;e++)c=this.freeCursorList[e],c.getDistanceToPoint(a)<d.getDistanceToPoint(a)&&(d=c);b=d.getCursorId(),this.freeCursorList=_.without(this.freeCursorList,function(a){return a.getCursorId()===b})}else this.maxCursorId=b;var g=new Tuio.Cursor({ttime:this.currentTime,si:a.getSessionId(),ci:b,xp:a.getX(),yp:a.getY()});this.cursorList[g.getSessionId()]=g,this.trigger("addTuioCursor",g)},cursorDefault:function(a){var b=this.cursorList[a.getSessionId()];a.getX()!==b.getX()&&0===a.getXSpeed()||a.getY()!==b.getY()&&0===a.getYSpeed()?b.update({ttime:this.currentTime,xp:a.getX(),yp:a.getY()}):b.update({ttime:this.currentTime,xp:a.getX(),yp:a.getY(),xs:a.getXSpeed(),ys:a.getYSpeed(),ma:a.getMotionAccel()}),this.trigger("updateTuioCursor",b)}})}!function(a){"undefined"==typeof window.extensionWasLoaded&&(window.extensionWasLoaded=!0,window.tuioObjects=[],window.trueUpdateCount=[],window.cursorID=0,window.latestObjectID=1e3,window.remove=[],window.add=[],window.latestTuioObject=null,window.expiringMicroseconds=5e4,window.client=new Tuio.Client({host:"http://localhost:5000"}),onAddTuioCursor=function(a){window.add[window.cursorID]=!0,window.remove[window.cursorID]=null},onUpdateTuioCursor=function(a){window.tuioObjects[window.cursorID]=a},onRemoveTuioCursor=function(a){window.remove[window.cursorID]=a},onAddTuioObject=function(a){window.add[a.symbolId]=!0,window.remove[a.symbolId]=null,window.tuioObjects[a.symbolId]=a},onUpdateTuioObject=function(a){window.tuioObjects[a.symbolId]=a,window.tuioObjects[-a.sessionId]=a,window.latestTuioObject=a},onRemoveTuioObject=function(a){window.remove[a.symbolId]=a,window.add[a.symbolId]=null,window.tuioObjects[a.symbolId]=null,window.tuioObjects[-a.sessionId]=null},onRefresh=function(a){},window.client.on("addTuioCursor",onAddTuioCursor),window.client.on("updateTuioCursor",onUpdateTuioCursor),window.client.on("removeTuioCursor",onRemoveTuioCursor),window.client.on("addTuioObject",onAddTuioObject),window.client.on("updateTuioObject",onUpdateTuioObject),window.client.on("removeTuioObject",onRemoveTuioObject),window.client.on("refresh",onRefresh),window.client.connect(),window.checkID=function(a){return(a==window.cursorID||a>0&&88>a)&&!isNaN(a)&&function(a){return(0|a)===a}(parseFloat(a))},window.convertXToScratchCoordinate=function(a){return Math.round(-240+480*a)},window.convertYToScratchCoordinate=function(a){return Math.round(180-360*a)}),a.updateEventHatBlock=function(a){if(window.trueUpdateCount[a]>1)return window.trueUpdateCount[a]=0,!1;var b=window.tuioObjects[a];if("undefined"==typeof b||null==b)return!1;var c=Tuio.Time.getSessionTime(),d=b.getTuioTime(),e=c.subtractTime(d),f=0==e.getSeconds()&&e.getMicroseconds()<=window.expiringMicroseconds;return f&&(window.trueUpdateCount[a]?window.trueUpdateCount[a]++:window.trueUpdateCount[a]=1),f},a.addEventHatBlock=function(a){return 1==window.checkID(a)&&1==window.add[a]?(window.add[a]=!1,!0):!1},a.removeEventHatBlock=function(a){var b=window.remove[a];if("undefined"==typeof b||null==b)return!1;var c=b.getTuioState();return c==Tuio.Container.TUIO_REMOVED},a.tuioObject=function(a){return a},a.tuioObjectSessionID=function(a){return-a},a.tuioCursor=function(){return window.cursorID},a.getTuioAttribute=function(a,b){var c;if(c=b==window.latestObjectID?window.latestTuioObject:window.tuioObjects[b],"undefined"==typeof c||null==c)return"ERROR: No object with "+b+" on camera!";switch(a){case h[d].objectAttributes[0]:return window.convertXToScratchCoordinate(c.getX());case h[d].objectAttributes[1]:return window.convertYToScratchCoordinate(c.getY());case h[d].objectAttributes[2]:return c.getAngleDegrees();case h[d].objectAttributes[3]:return c.getMotionSpeed();case h[d].objectAttributes[4]:return c.getMotionAccel();case h[d].objectAttributes[5]:return c.getRotationSpeed();case h[d].objectAttributes[6]:return c.getRotationAccel();case h[d].objectAttributes[7]:return c.getXSpeed();case h[d].objectAttributes[8]:return c.getYSpeed();case h[d].objectAttributes[9]:return c.sessionId}},a.getStateOfTuioObject=function(a,b){var c;if(c=a==window.latestObjectID?window.latestTuioObject:window.tuioObjects[a],"undefined"==typeof c||null==c)return"ERROR: No object with "+a+" on camera!";var e=c.getTuioState();switch(b){case h[d].objectStates[0]:return e===Tuio.Object.TUIO_ACCELERATING||e===Tuio.Object.TUIO_DECELERATING||e===Tuio.Object.TUIO_ROTATING;case h[d].objectStates[1]:return e==Tuio.Object.TUIO_ACCELERATING;case h[d].objectStates[2]:return e==Tuio.Object.TUIO_DECELERATING;case h[d].objectStates[3]:return e==Tuio.Object.TUIO_ROTATING}},a.updateOnAnyObject=function(){var a=window.latestObjectID;if(window.trueUpdateCount[a]>1)return window.trueUpdateCount[a]=0,!1;var b=window.latestTuioObject;if("undefined"==typeof b||null==b)return!1;var c=Tuio.Time.getSessionTime(),d=b.getTuioTime(),e=c.subtractTime(d),f=0==e.getSeconds()&&e.getMicroseconds()<=window.expiringMicroseconds;return f&&(window.trueUpdateCount[a]?window.trueUpdateCount[a]++:window.trueUpdateCount[a]=1),f},a.getLatestTuioObject=function(){return window.latestObjectID},a._shutdown=function(){window.client.socket.emit("Disconnect"),window.client.onDisconnect(),console.log("Shutting down...")},a._getStatus=function(){return{status:2,msg:"Ready"}};for(var b=window.location.search.replace(/^\?|\/$/g,""),c=b.split("&"),d="en",e=0;e<c.length;e++){var f=c[e].split("=");f.length>1&&"lang"==f[0]&&(d=f[1])}var g={en:[["h","when %n updated","updateEventHatBlock",""],["h","when %n added","addEventHatBlock",""],["h","when %n removed","removeEventHatBlock",""],["h","when any tuio object updated","updateOnAnyObject",""],["r","latest TUIO Object","getLatestTuioObject",""],["r","TUIO-Object with symbolID %n","tuioObject",""],["r","TUIO-Object with sessionID %n","tuioObjectSessionID",""],["r","TUIO-Cursor","tuioCursor",""],["r","attribute %m.objectAttributes of %n","getTuioAttribute",""],["b","Is %n %m.objectStates ?","getStateOfTuioObject",""]],de:[["h","falls %n ein Update erhält","updateEventHatBlock",""],["h","falls %n hinzugefügt wird","addEventHatBlock",""],["h","falls %n entfernt wird","removeEventHatBlock",""],["h","falls irgendein TUIO-Objekt geupdatet wird","updateOnAnyObject",""],["r","zuletzt verändertes TUIO-Objekt ","getLatestTuioObject",""],["r","TUIO-Objekt mit der Symbolnummer %n","tuioObject",""],["r","TUIO-Objekt mit der Sitzungsnummer %n","tuioObjectSessionID",""],["r","TUIO-Zeiger","tuioCursor",""],["r","Attribut %m.objectAttributes von %n","getTuioAttribute",""],["b","Ist %n %m.objectStates?","getStateOfTuioObject",""]]},h={en:{objectAttributes:["Position X","Position Y","Angle","Motion Speed","Motion Accel","Rotation Speed","Rotation Accel","xSpeed","ySpeed","sessionID"],objectStates:["moving","accelerating","decelerating","rotating"]},de:{objectAttributes:["Position X","Position Y","Winkel","Bewegungsgeschwindigkeit","Bewegungsbeschleunigung","Drehgeschwindigkeit","Drehbeschleunigung","xGeschwindigkeit","yGeschwindigkeit","Sitzungsnummer"],objectStates:["in Bewegung","am Beschleunigen","am Bremsen","am Drehen"]}},i={blocks:g[d],menus:h[d]};ScratchExtensions.register("TUIO4Scratch",i,a)}({});